<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Quantitive Social Science: The R Tidyverse Code</title>
  <meta name="description" content="This supplement for Kosuke Imai’s “Quantitative Social Science: An Introduction” contains Tidyverse R code versions of the code in the original text.">
  <meta name="generator" content="bookdown 0.7.1 and GitBook 2.6.7">

  <meta property="og:title" content="Quantitive Social Science: The R Tidyverse Code" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://jrnold.github.io/qss-tidy" />
  
  <meta property="og:description" content="This supplement for Kosuke Imai’s “Quantitative Social Science: An Introduction” contains Tidyverse R code versions of the code in the original text." />
  <meta name="github-repo" content="jrnold/qss-tidy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Quantitive Social Science: The R Tidyverse Code" />
  
  <meta name="twitter:description" content="This supplement for Kosuke Imai’s “Quantitative Social Science: An Introduction” contains Tidyverse R code versions of the code in the original text." />
  

<meta name="author" content="Jeffrey B. Arnold">


<meta name="date" content="2018-02-26">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="causality.html">
<link rel="next" href="prediction.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">QSS Tidyverse Code</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#colophon"><i class="fa fa-check"></i>Colophon</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#overview-of-the-book"><i class="fa fa-check"></i><b>1.1</b> Overview of the Book</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#how-to-use-the-book"><i class="fa fa-check"></i><b>1.2</b> How to use the Book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#introduction-to-r"><i class="fa fa-check"></i><b>1.3</b> Introduction to R</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#arithmetic-operations"><i class="fa fa-check"></i><b>1.3.1</b> Arithmetic Operations</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#objects"><i class="fa fa-check"></i><b>1.3.2</b> Objects</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction.html"><a href="introduction.html#vectors"><i class="fa fa-check"></i><b>1.3.3</b> Vectors</a></li>
<li class="chapter" data-level="1.3.4" data-path="introduction.html"><a href="introduction.html#functions"><i class="fa fa-check"></i><b>1.3.4</b> Functions</a></li>
<li class="chapter" data-level="1.3.5" data-path="introduction.html"><a href="introduction.html#data-files"><i class="fa fa-check"></i><b>1.3.5</b> Data Files</a></li>
<li class="chapter" data-level="1.3.6" data-path="introduction.html"><a href="introduction.html#saving-objects"><i class="fa fa-check"></i><b>1.3.6</b> Saving Objects</a></li>
<li class="chapter" data-level="1.3.7" data-path="introduction.html"><a href="introduction.html#programming-and-learning-tips"><i class="fa fa-check"></i><b>1.3.7</b> Programming and Learning Tips</a></li>
<li class="chapter" data-level="1.3.8" data-path="introduction.html"><a href="introduction.html#style-guide"><i class="fa fa-check"></i><b>1.3.8</b> Style Guide</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="causality.html"><a href="causality.html"><i class="fa fa-check"></i><b>2</b> Causality</a><ul>
<li class="chapter" data-level="" data-path="causality.html"><a href="causality.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="2.1" data-path="causality.html"><a href="causality.html#racial-discrimination-in-the-labor-market"><i class="fa fa-check"></i><b>2.1</b> Racial Discrimination in the Labor Market</a></li>
<li class="chapter" data-level="2.2" data-path="causality.html"><a href="causality.html#subsetting-data-in-r"><i class="fa fa-check"></i><b>2.2</b> Subsetting Data in R</a><ul>
<li class="chapter" data-level="2.2.1" data-path="causality.html"><a href="causality.html#subsetting"><i class="fa fa-check"></i><b>2.2.1</b> Subsetting</a></li>
<li class="chapter" data-level="2.2.2" data-path="causality.html"><a href="causality.html#simple-conditional-statements"><i class="fa fa-check"></i><b>2.2.2</b> Simple conditional statements</a></li>
<li class="chapter" data-level="2.2.3" data-path="causality.html"><a href="causality.html#factor-variables"><i class="fa fa-check"></i><b>2.2.3</b> Factor Variables</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="causality.html"><a href="causality.html#causal-affects-and-the-counterfactual"><i class="fa fa-check"></i><b>2.3</b> Causal Affects and the Counterfactual</a></li>
<li class="chapter" data-level="2.4" data-path="causality.html"><a href="causality.html#observational-studies"><i class="fa fa-check"></i><b>2.4</b> Observational Studies</a><ul>
<li class="chapter" data-level="2.4.1" data-path="causality.html"><a href="causality.html#confounding-bias"><i class="fa fa-check"></i><b>2.4.1</b> Confounding Bias</a></li>
<li class="chapter" data-level="2.4.2" data-path="causality.html"><a href="causality.html#before-and-after-and-difference-in-difference-designs"><i class="fa fa-check"></i><b>2.4.2</b> Before and After and Difference-in-Difference Designs</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="causality.html"><a href="causality.html#descriptive-statistics-for-a-single-variable"><i class="fa fa-check"></i><b>2.5</b> Descriptive Statistics for a Single Variable</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="measurement.html"><a href="measurement.html"><i class="fa fa-check"></i><b>3</b> Measurement</a><ul>
<li class="chapter" data-level="" data-path="measurement.html"><a href="measurement.html#prerequisites-2"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="3.1" data-path="measurement.html"><a href="measurement.html#measuring-civilian-victimization-during-wartime"><i class="fa fa-check"></i><b>3.1</b> Measuring Civilian Victimization during Wartime</a></li>
<li class="chapter" data-level="3.2" data-path="measurement.html"><a href="measurement.html#handling-missing-data-in-r"><i class="fa fa-check"></i><b>3.2</b> Handling Missing Data in R</a></li>
<li class="chapter" data-level="3.3" data-path="measurement.html"><a href="measurement.html#visualizing-the-univariate-distribution"><i class="fa fa-check"></i><b>3.3</b> Visualizing the Univariate Distribution</a><ul>
<li class="chapter" data-level="3.3.1" data-path="measurement.html"><a href="measurement.html#barplot"><i class="fa fa-check"></i><b>3.3.1</b> Barplot</a></li>
<li class="chapter" data-level="3.3.2" data-path="measurement.html"><a href="measurement.html#histogram"><i class="fa fa-check"></i><b>3.3.2</b> Histogram</a></li>
<li class="chapter" data-level="3.3.3" data-path="measurement.html"><a href="measurement.html#boxplot"><i class="fa fa-check"></i><b>3.3.3</b> Boxplot</a></li>
<li class="chapter" data-level="3.3.4" data-path="measurement.html"><a href="measurement.html#printing-and-saving-graphics"><i class="fa fa-check"></i><b>3.3.4</b> Printing and saving graphics</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="measurement.html"><a href="measurement.html#survey-sampling"><i class="fa fa-check"></i><b>3.4</b> Survey Sampling</a><ul>
<li class="chapter" data-level="3.4.1" data-path="measurement.html"><a href="measurement.html#the-role-of-randomization"><i class="fa fa-check"></i><b>3.4.1</b> The Role of Randomization</a></li>
<li class="chapter" data-level="3.4.2" data-path="measurement.html"><a href="measurement.html#non-response-and-other-sources-of-bias"><i class="fa fa-check"></i><b>3.4.2</b> Non-response and other sources of bias</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="measurement.html"><a href="measurement.html#measuring-political-polarization"><i class="fa fa-check"></i><b>3.5</b> Measuring Political Polarization</a><ul>
<li class="chapter" data-level="3.5.1" data-path="measurement.html"><a href="measurement.html#correlation"><i class="fa fa-check"></i><b>3.5.1</b> Correlation</a></li>
<li class="chapter" data-level="3.5.2" data-path="measurement.html"><a href="measurement.html#quantile-quantile-plot"><i class="fa fa-check"></i><b>3.5.2</b> Quantile-Quantile Plot</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="measurement.html"><a href="measurement.html#clustering"><i class="fa fa-check"></i><b>3.6</b> Clustering</a><ul>
<li class="chapter" data-level="3.6.1" data-path="measurement.html"><a href="measurement.html#matrices"><i class="fa fa-check"></i><b>3.6.1</b> Matrices</a></li>
<li class="chapter" data-level="3.6.2" data-path="measurement.html"><a href="measurement.html#lists"><i class="fa fa-check"></i><b>3.6.2</b> Lists</a></li>
<li class="chapter" data-level="3.6.3" data-path="measurement.html"><a href="measurement.html#k-means-algorithms"><i class="fa fa-check"></i><b>3.6.3</b> k-means algorithms</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="prediction.html"><a href="prediction.html"><i class="fa fa-check"></i><b>4</b> Prediction</a><ul>
<li class="chapter" data-level="" data-path="prediction.html"><a href="prediction.html#prerequisites-3"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="4.1" data-path="prediction.html"><a href="prediction.html#predicting-election-outcomes"><i class="fa fa-check"></i><b>4.1</b> Predicting Election Outcomes</a><ul>
<li class="chapter" data-level="4.1.1" data-path="prediction.html"><a href="prediction.html#loops-in-r"><i class="fa fa-check"></i><b>4.1.1</b> Loops in R</a></li>
<li class="chapter" data-level="4.1.2" data-path="prediction.html"><a href="prediction.html#general-conditional-statements-in-r"><i class="fa fa-check"></i><b>4.1.2</b> General Conditional Statements in R</a></li>
<li class="chapter" data-level="4.1.3" data-path="prediction.html"><a href="prediction.html#poll-predictions"><i class="fa fa-check"></i><b>4.1.3</b> Poll Predictions</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="prediction.html"><a href="prediction.html#linear-regression"><i class="fa fa-check"></i><b>4.2</b> Linear Regression</a><ul>
<li class="chapter" data-level="4.2.1" data-path="prediction.html"><a href="prediction.html#facial-appearance-and-election-outcomes"><i class="fa fa-check"></i><b>4.2.1</b> Facial Appearance and Election Outcomes</a></li>
<li class="chapter" data-level="4.2.2" data-path="prediction.html"><a href="prediction.html#correlation-and-scatter-plots"><i class="fa fa-check"></i><b>4.2.2</b> Correlation and Scatter Plots</a></li>
<li class="chapter" data-level="4.2.3" data-path="prediction.html"><a href="prediction.html#least-squares"><i class="fa fa-check"></i><b>4.2.3</b> Least Squares</a></li>
<li class="chapter" data-level="4.2.4" data-path="prediction.html"><a href="prediction.html#regression-towards-the-mean"><i class="fa fa-check"></i><b>4.2.4</b> Regression towards the mean</a></li>
<li class="chapter" data-level="4.2.5" data-path="prediction.html"><a href="prediction.html#merging-data-sets-in-r"><i class="fa fa-check"></i><b>4.2.5</b> Merging Data Sets in R</a></li>
<li class="chapter" data-level="4.2.6" data-path="prediction.html"><a href="prediction.html#model-fit"><i class="fa fa-check"></i><b>4.2.6</b> Model Fit</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="prediction.html"><a href="prediction.html#regression-and-causation"><i class="fa fa-check"></i><b>4.3</b> Regression and Causation</a><ul>
<li class="chapter" data-level="4.3.1" data-path="prediction.html"><a href="prediction.html#randomized-experiments"><i class="fa fa-check"></i><b>4.3.1</b> Randomized Experiments</a></li>
<li class="chapter" data-level="4.3.2" data-path="prediction.html"><a href="prediction.html#regression-with-multiple-predictors"><i class="fa fa-check"></i><b>4.3.2</b> Regression with multiple predictors</a></li>
<li class="chapter" data-level="4.3.3" data-path="prediction.html"><a href="prediction.html#heterogeneous-treatment-effects"><i class="fa fa-check"></i><b>4.3.3</b> Heterogeneous Treatment Effects</a></li>
<li class="chapter" data-level="4.3.4" data-path="prediction.html"><a href="prediction.html#regression-discontinuity-design"><i class="fa fa-check"></i><b>4.3.4</b> Regression Discontinuity Design</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="discovery.html"><a href="discovery.html"><i class="fa fa-check"></i><b>5</b> Discovery</a><ul>
<li class="chapter" data-level="5.1" data-path="discovery.html"><a href="discovery.html#textual-data"><i class="fa fa-check"></i><b>5.1</b> Textual data</a><ul>
<li class="chapter" data-level="" data-path="discovery.html"><a href="discovery.html#prerequisites-4"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="5.1.1" data-path="discovery.html"><a href="discovery.html#document-term-matrix"><i class="fa fa-check"></i><b>5.1.1</b> Document-Term Matrix</a></li>
<li class="chapter" data-level="5.1.2" data-path="discovery.html"><a href="discovery.html#topic-discovery"><i class="fa fa-check"></i><b>5.1.2</b> Topic Discovery</a></li>
<li class="chapter" data-level="5.1.3" data-path="discovery.html"><a href="discovery.html#authorship-prediction"><i class="fa fa-check"></i><b>5.1.3</b> Authorship Prediction</a></li>
<li class="chapter" data-level="5.1.4" data-path="discovery.html"><a href="discovery.html#cross-validation"><i class="fa fa-check"></i><b>5.1.4</b> Cross-Validation</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="discovery.html"><a href="discovery.html#network-data"><i class="fa fa-check"></i><b>5.2</b> Network data</a><ul>
<li class="chapter" data-level="" data-path="discovery.html"><a href="discovery.html#prerequisites-5"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="5.2.1" data-path="discovery.html"><a href="discovery.html#twitter-following-network"><i class="fa fa-check"></i><b>5.2.1</b> Twitter Following Network</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="discovery.html"><a href="discovery.html#spatial-data"><i class="fa fa-check"></i><b>5.3</b> Spatial Data</a><ul>
<li class="chapter" data-level="" data-path="discovery.html"><a href="discovery.html#prerequisites-6"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="5.3.1" data-path="discovery.html"><a href="discovery.html#spatial-data-in-r"><i class="fa fa-check"></i><b>5.3.1</b> Spatial Data in R</a></li>
<li class="chapter" data-level="5.3.2" data-path="discovery.html"><a href="discovery.html#colors-in-r"><i class="fa fa-check"></i><b>5.3.2</b> Colors in R</a></li>
<li class="chapter" data-level="5.3.3" data-path="discovery.html"><a href="discovery.html#united-states-presidential-elections"><i class="fa fa-check"></i><b>5.3.3</b> United States Presidential Elections</a></li>
<li class="chapter" data-level="5.3.4" data-path="discovery.html"><a href="discovery.html#expansion-of-walmart"><i class="fa fa-check"></i><b>5.3.4</b> Expansion of Walmart</a></li>
<li class="chapter" data-level="5.3.5" data-path="discovery.html"><a href="discovery.html#animation-in-r"><i class="fa fa-check"></i><b>5.3.5</b> Animation in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>6</b> Probability</a><ul>
<li class="chapter" data-level="" data-path="probability.html"><a href="probability.html#prerequisites-7"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="6.1" data-path="probability.html"><a href="probability.html#probability-1"><i class="fa fa-check"></i><b>6.1</b> Probability</a><ul>
<li class="chapter" data-level="6.1.1" data-path="probability.html"><a href="probability.html#frequentist-vs.bayesian"><i class="fa fa-check"></i><b>6.1.1</b> Frequentist vs. Bayesian</a></li>
<li class="chapter" data-level="6.1.2" data-path="probability.html"><a href="probability.html#definition-and-axioms"><i class="fa fa-check"></i><b>6.1.2</b> Definition and Axioms</a></li>
<li class="chapter" data-level="6.1.3" data-path="probability.html"><a href="probability.html#permutations"><i class="fa fa-check"></i><b>6.1.3</b> Permutations</a></li>
<li class="chapter" data-level="6.1.4" data-path="probability.html"><a href="probability.html#sampling-without-replacement"><i class="fa fa-check"></i><b>6.1.4</b> Sampling without replacement</a></li>
<li class="chapter" data-level="6.1.5" data-path="probability.html"><a href="probability.html#combinations"><i class="fa fa-check"></i><b>6.1.5</b> Combinations</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="probability.html"><a href="probability.html#conditional-probability"><i class="fa fa-check"></i><b>6.2</b> Conditional Probability</a><ul>
<li class="chapter" data-level="6.2.1" data-path="probability.html"><a href="probability.html#conditional-marginal-and-joint-probabilities"><i class="fa fa-check"></i><b>6.2.1</b> Conditional, Marginal, and Joint Probabilities</a></li>
<li class="chapter" data-level="6.2.2" data-path="probability.html"><a href="probability.html#independence"><i class="fa fa-check"></i><b>6.2.2</b> Independence</a></li>
<li class="chapter" data-level="6.2.3" data-path="probability.html"><a href="probability.html#bayes-rule"><i class="fa fa-check"></i><b>6.2.3</b> Bayes’ Rule</a></li>
<li class="chapter" data-level="6.2.4" data-path="probability.html"><a href="probability.html#predicting-race-using-surname-and-residence-location"><i class="fa fa-check"></i><b>6.2.4</b> Predicting Race Using Surname and Residence Location</a></li>
<li class="chapter" data-level="6.2.5" data-path="probability.html"><a href="probability.html#predicting-election-outcomes-with-uncertainty"><i class="fa fa-check"></i><b>6.2.5</b> Predicting Election Outcomes with Uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="probability.html"><a href="probability.html#random-variables-and-probability-distributions"><i class="fa fa-check"></i><b>6.3</b> Random Variables and Probability Distributions</a><ul>
<li class="chapter" data-level="6.3.1" data-path="probability.html"><a href="probability.html#bernoulli-and-uniform-distributions"><i class="fa fa-check"></i><b>6.3.1</b> Bernoulli and Uniform Distributions</a></li>
<li class="chapter" data-level="6.3.2" data-path="probability.html"><a href="probability.html#binomial-distribution"><i class="fa fa-check"></i><b>6.3.2</b> Binomial distribution</a></li>
<li class="chapter" data-level="6.3.3" data-path="probability.html"><a href="probability.html#normal-distribution"><i class="fa fa-check"></i><b>6.3.3</b> Normal distribution</a></li>
<li class="chapter" data-level="6.3.4" data-path="probability.html"><a href="probability.html#expectation-and-variance"><i class="fa fa-check"></i><b>6.3.4</b> Expectation and Variance</a></li>
<li class="chapter" data-level="6.3.5" data-path="probability.html"><a href="probability.html#predicting-election-outcomes-with-uncertainty-1"><i class="fa fa-check"></i><b>6.3.5</b> Predicting Election Outcomes with Uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="probability.html"><a href="probability.html#large-sample-theorems"><i class="fa fa-check"></i><b>6.4</b> Large Sample Theorems</a><ul>
<li class="chapter" data-level="6.4.1" data-path="probability.html"><a href="probability.html#law-of-large-numbers"><i class="fa fa-check"></i><b>6.4.1</b> Law of Large Numbers</a></li>
<li class="chapter" data-level="6.4.2" data-path="probability.html"><a href="probability.html#central-limit-theorem"><i class="fa fa-check"></i><b>6.4.2</b> Central Limit Theorem</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>7</b> Uncertainty</a><ul>
<li class="chapter" data-level="" data-path="uncertainty.html"><a href="uncertainty.html#prerequisites-8"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="7.1" data-path="uncertainty.html"><a href="uncertainty.html#estimation"><i class="fa fa-check"></i><b>7.1</b> Estimation</a><ul>
<li class="chapter" data-level="7.1.1" data-path="uncertainty.html"><a href="uncertainty.html#unbiasedness-and-consistency"><i class="fa fa-check"></i><b>7.1.1</b> Unbiasedness and Consistency</a></li>
<li class="chapter" data-level="7.1.2" data-path="uncertainty.html"><a href="uncertainty.html#standard-error"><i class="fa fa-check"></i><b>7.1.2</b> Standard Error</a></li>
<li class="chapter" data-level="7.1.3" data-path="uncertainty.html"><a href="uncertainty.html#confidence-intervals"><i class="fa fa-check"></i><b>7.1.3</b> Confidence Intervals</a></li>
<li class="chapter" data-level="7.1.4" data-path="uncertainty.html"><a href="uncertainty.html#margin-of-error-and-sample-size-calculation-in-polls"><i class="fa fa-check"></i><b>7.1.4</b> Margin of Error and Sample Size Calculation in Polls</a></li>
<li class="chapter" data-level="7.1.5" data-path="uncertainty.html"><a href="uncertainty.html#analysis-of-randomized-controlled-trials"><i class="fa fa-check"></i><b>7.1.5</b> Analysis of Randomized Controlled Trials</a></li>
<li class="chapter" data-level="7.1.6" data-path="uncertainty.html"><a href="uncertainty.html#analysis-based-on-students-t-distribution"><i class="fa fa-check"></i><b>7.1.6</b> Analysis Based on Student’s t-Distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="uncertainty.html"><a href="uncertainty.html#hypothesis-testing"><i class="fa fa-check"></i><b>7.2</b> Hypothesis Testing</a><ul>
<li class="chapter" data-level="7.2.1" data-path="uncertainty.html"><a href="uncertainty.html#tea-testing-experiment"><i class="fa fa-check"></i><b>7.2.1</b> Tea-Testing Experiment</a></li>
<li class="chapter" data-level="7.2.2" data-path="uncertainty.html"><a href="uncertainty.html#the-general-framework"><i class="fa fa-check"></i><b>7.2.2</b> The General Framework</a></li>
<li class="chapter" data-level="7.2.3" data-path="uncertainty.html"><a href="uncertainty.html#one-sample-tests"><i class="fa fa-check"></i><b>7.2.3</b> One-Sample Tests</a></li>
<li class="chapter" data-level="7.2.4" data-path="uncertainty.html"><a href="uncertainty.html#two-sample-tests"><i class="fa fa-check"></i><b>7.2.4</b> Two-sample tests</a></li>
<li class="chapter" data-level="7.2.5" data-path="uncertainty.html"><a href="uncertainty.html#power-analysis"><i class="fa fa-check"></i><b>7.2.5</b> Power Analysis</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="uncertainty.html"><a href="uncertainty.html#linear-regression-model-with-uncertainty"><i class="fa fa-check"></i><b>7.3</b> Linear Regression Model with Uncertainty</a><ul>
<li class="chapter" data-level="7.3.1" data-path="uncertainty.html"><a href="uncertainty.html#linear-regression-as-a-generative-model"><i class="fa fa-check"></i><b>7.3.1</b> Linear Regression as a Generative Model</a></li>
<li class="chapter" data-level="7.3.2" data-path="uncertainty.html"><a href="uncertainty.html#inference-about-coefficients"><i class="fa fa-check"></i><b>7.3.2</b> Inference about coefficients</a></li>
<li class="chapter" data-level="7.3.3" data-path="uncertainty.html"><a href="uncertainty.html#inference-about-predictions"><i class="fa fa-check"></i><b>7.3.3</b> Inference about predictions</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitive Social Science: The R Tidyverse Code</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="measurement" class="section level1">
<h1><span class="header-section-number">3</span> Measurement</h1>
<div id="prerequisites-2" class="section level2 unnumbered">
<h2>Prerequisites</h2>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</a>
<a class="sourceLine" id="cb82-2" data-line-number="2"><span class="kw">library</span>(<span class="st">&quot;forcats&quot;</span>)</a>
<a class="sourceLine" id="cb82-3" data-line-number="3"><span class="kw">library</span>(<span class="st">&quot;broom&quot;</span>)</a>
<a class="sourceLine" id="cb82-4" data-line-number="4"><span class="kw">library</span>(<span class="st">&quot;tidyr&quot;</span>)</a></code></pre></div>
</div>
<div id="measuring-civilian-victimization-during-wartime" class="section level2">
<h2><span class="header-section-number">3.1</span> Measuring Civilian Victimization during Wartime</h2>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;afghan&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;qss&quot;</span>)</a></code></pre></div>
<p>Summarize the variables of interest</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1">afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb84-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(age, educ.years, employed, income) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb84-3" data-line-number="3"><span class="st">  </span><span class="kw">summary</span>()</a>
<a class="sourceLine" id="cb84-4" data-line-number="4"><span class="co">#&gt;       age         educ.years    employed        income         </span></a>
<a class="sourceLine" id="cb84-5" data-line-number="5"><span class="co">#&gt;  Min.   :15.0   Min.   : 0   Min.   :0.000   Length:2754       </span></a>
<a class="sourceLine" id="cb84-6" data-line-number="6"><span class="co">#&gt;  1st Qu.:22.0   1st Qu.: 0   1st Qu.:0.000   Class :character  </span></a>
<a class="sourceLine" id="cb84-7" data-line-number="7"><span class="co">#&gt;  Median :30.0   Median : 1   Median :1.000   Mode  :character  </span></a>
<a class="sourceLine" id="cb84-8" data-line-number="8"><span class="co">#&gt;  Mean   :32.4   Mean   : 4   Mean   :0.583                     </span></a>
<a class="sourceLine" id="cb84-9" data-line-number="9"><span class="co">#&gt;  3rd Qu.:40.0   3rd Qu.: 8   3rd Qu.:1.000                     </span></a>
<a class="sourceLine" id="cb84-10" data-line-number="10"><span class="co">#&gt;  Max.   :80.0   Max.   :18   Max.   :1.000</span></a></code></pre></div>
<p>Loading data with either <code>data()</code> or<code>read_csv()</code> does not convert strings to factors by default; see below with <code>income</code>.
To get a summary of the different levels, either convert it to a factor (see <a href="http://r4ds.had.co.nz/factors.html">R4DS Ch 15</a>), or use <code>count()</code>:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1"><span class="kw">count</span>(afghan, income)</a>
<a class="sourceLine" id="cb85-2" data-line-number="2"><span class="co">#&gt; # A tibble: 6 x 2</span></a>
<a class="sourceLine" id="cb85-3" data-line-number="3"><span class="co">#&gt;   income              n</span></a>
<a class="sourceLine" id="cb85-4" data-line-number="4"><span class="co">#&gt;   &lt;chr&gt;           &lt;int&gt;</span></a>
<a class="sourceLine" id="cb85-5" data-line-number="5"><span class="co">#&gt; 1 10,001-20,000     616</span></a>
<a class="sourceLine" id="cb85-6" data-line-number="6"><span class="co">#&gt; 2 2,001-10,000     1420</span></a>
<a class="sourceLine" id="cb85-7" data-line-number="7"><span class="co">#&gt; 3 20,001-30,000      93</span></a>
<a class="sourceLine" id="cb85-8" data-line-number="8"><span class="co">#&gt; 4 less than 2,000   457</span></a>
<a class="sourceLine" id="cb85-9" data-line-number="9"><span class="co">#&gt; 5 over 30,000        14</span></a>
<a class="sourceLine" id="cb85-10" data-line-number="10"><span class="co">#&gt; 6 &lt;NA&gt;              154</span></a></code></pre></div>
<p>Use count to calculate the proportion of respondents who answer that they were harmed by the ISAF or the Taliban (<code>violent.exp.ISAF</code> and <code>violent.exp.taliban</code>, respectively):</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1">afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb86-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(violent.exp.ISAF, violent.exp.taliban) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb86-3" data-line-number="3"><span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb86-4" data-line-number="4"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb86-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n))</a>
<a class="sourceLine" id="cb86-6" data-line-number="6"><span class="co">#&gt; # A tibble: 9 x 4</span></a>
<a class="sourceLine" id="cb86-7" data-line-number="7"><span class="co">#&gt;   violent.exp.ISAF violent.exp.taliban     n    prop</span></a>
<a class="sourceLine" id="cb86-8" data-line-number="8"><span class="co">#&gt;              &lt;int&gt;               &lt;int&gt; &lt;int&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb86-9" data-line-number="9"><span class="co">#&gt; 1                0                   0  1330 0.48293</span></a>
<a class="sourceLine" id="cb86-10" data-line-number="10"><span class="co">#&gt; 2                0                   1   354 0.12854</span></a>
<a class="sourceLine" id="cb86-11" data-line-number="11"><span class="co">#&gt; 3                0                  NA    22 0.00799</span></a>
<a class="sourceLine" id="cb86-12" data-line-number="12"><span class="co">#&gt; 4                1                   0   475 0.17248</span></a>
<a class="sourceLine" id="cb86-13" data-line-number="13"><span class="co">#&gt; 5                1                   1   526 0.19099</span></a>
<a class="sourceLine" id="cb86-14" data-line-number="14"><span class="co">#&gt; 6                1                  NA    22 0.00799</span></a>
<a class="sourceLine" id="cb86-15" data-line-number="15"><span class="co">#&gt; # ... with 3 more rows</span></a></code></pre></div>
<p>We need to use <code>ungroup()</code> in order to ensure that <code>sum(n)</code> sums over the entire
dataset as opposed to only within categories of <code>violent.exp.ISAF</code>.
Unlike <code>prop.table()</code>, the code above does not drop missing values.
We can drop those values by adding <code>filter()</code> and <code>!is.na()</code> to test
for missing values in those variables:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1">afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb87-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(violent.exp.ISAF), <span class="op">!</span><span class="kw">is.na</span>(violent.exp.taliban)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb87-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(violent.exp.ISAF, violent.exp.taliban) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb87-4" data-line-number="4"><span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb87-5" data-line-number="5"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb87-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n))</a>
<a class="sourceLine" id="cb87-7" data-line-number="7"><span class="co">#&gt; # A tibble: 4 x 4</span></a>
<a class="sourceLine" id="cb87-8" data-line-number="8"><span class="co">#&gt;   violent.exp.ISAF violent.exp.taliban     n  prop</span></a>
<a class="sourceLine" id="cb87-9" data-line-number="9"><span class="co">#&gt;              &lt;int&gt;               &lt;int&gt; &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb87-10" data-line-number="10"><span class="co">#&gt; 1                0                   0  1330 0.495</span></a>
<a class="sourceLine" id="cb87-11" data-line-number="11"><span class="co">#&gt; 2                0                   1   354 0.132</span></a>
<a class="sourceLine" id="cb87-12" data-line-number="12"><span class="co">#&gt; 3                1                   0   475 0.177</span></a>
<a class="sourceLine" id="cb87-13" data-line-number="13"><span class="co">#&gt; 4                1                   1   526 0.196</span></a></code></pre></div>
</div>
<div id="handling-missing-data-in-r" class="section level2">
<h2><span class="header-section-number">3.2</span> Handling Missing Data in R</h2>
<p>We already observed the issues with <code>NA</code> values in calculating the proportion
answering the “experienced violence” questions.
You can filter rows with specific variables having missing values using <code>filter()</code>
as shown above.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1"><span class="kw">head</span>(afghan<span class="op">$</span>income, <span class="dt">n =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb88-2" data-line-number="2"><span class="co">#&gt;  [1] &quot;2,001-10,000&quot;  &quot;2,001-10,000&quot;  &quot;2,001-10,000&quot;  &quot;2,001-10,000&quot; </span></a>
<a class="sourceLine" id="cb88-3" data-line-number="3"><span class="co">#&gt;  [5] &quot;2,001-10,000&quot;  NA              &quot;10,001-20,000&quot; &quot;2,001-10,000&quot; </span></a>
<a class="sourceLine" id="cb88-4" data-line-number="4"><span class="co">#&gt;  [9] &quot;2,001-10,000&quot;  NA</span></a>
<a class="sourceLine" id="cb88-5" data-line-number="5"><span class="kw">head</span>(<span class="kw">is.na</span>(afghan<span class="op">$</span>income), <span class="dt">n =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb88-6" data-line-number="6"><span class="co">#&gt;  [1] FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE  TRUE</span></a></code></pre></div>
<p>Counts and proportion of missing values of <code>income</code>:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1"><span class="kw">summarise</span>(afghan,</a>
<a class="sourceLine" id="cb89-2" data-line-number="2">          <span class="dt">n_missing =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(income)),</a>
<a class="sourceLine" id="cb89-3" data-line-number="3">          <span class="dt">p_missing =</span> <span class="kw">mean</span>(<span class="kw">is.na</span>(income)))</a>
<a class="sourceLine" id="cb89-4" data-line-number="4"><span class="co">#&gt;   n_missing p_missing</span></a>
<a class="sourceLine" id="cb89-5" data-line-number="5"><span class="co">#&gt; 1       154    0.0559</span></a></code></pre></div>
<p>Mean, and other functions, do not by default exclude missing values. Use <code>na.rm = TRUE</code> in these cases.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb90-2" data-line-number="2"><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb90-3" data-line-number="3"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb90-4" data-line-number="4"><span class="kw">mean</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb90-5" data-line-number="5"><span class="co">#&gt; [1] 2</span></a></code></pre></div>
<p>Table of proportions of individuals harmed by the ISAF and Taliban that includes missing (<code>NA</code>) values:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1">violent_exp_prop &lt;-</a>
<a class="sourceLine" id="cb91-2" data-line-number="2"><span class="st">  </span>afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(violent.exp.ISAF, violent.exp.taliban) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-4" data-line-number="4"><span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-5" data-line-number="5"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-7" data-line-number="7"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>n)</a>
<a class="sourceLine" id="cb91-8" data-line-number="8">violent_exp_prop</a>
<a class="sourceLine" id="cb91-9" data-line-number="9"><span class="co">#&gt; # A tibble: 9 x 3</span></a>
<a class="sourceLine" id="cb91-10" data-line-number="10"><span class="co">#&gt;   violent.exp.ISAF violent.exp.taliban    prop</span></a>
<a class="sourceLine" id="cb91-11" data-line-number="11"><span class="co">#&gt;              &lt;int&gt;               &lt;int&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb91-12" data-line-number="12"><span class="co">#&gt; 1                0                   0 0.483  </span></a>
<a class="sourceLine" id="cb91-13" data-line-number="13"><span class="co">#&gt; 2                0                   1 0.129  </span></a>
<a class="sourceLine" id="cb91-14" data-line-number="14"><span class="co">#&gt; 3                0                  NA 0.00799</span></a>
<a class="sourceLine" id="cb91-15" data-line-number="15"><span class="co">#&gt; 4                1                   0 0.172  </span></a>
<a class="sourceLine" id="cb91-16" data-line-number="16"><span class="co">#&gt; 5                1                   1 0.191  </span></a>
<a class="sourceLine" id="cb91-17" data-line-number="17"><span class="co">#&gt; 6                1                  NA 0.00799</span></a>
<a class="sourceLine" id="cb91-18" data-line-number="18"><span class="co">#&gt; # ... with 3 more rows</span></a></code></pre></div>
<p>The data frame above can be reorganized so that rows are ISAF and the columns are Taliban as follows:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1">violent_exp_prop <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb92-2" data-line-number="2"><span class="st">  </span><span class="kw">spread</span>(violent.exp.taliban, prop)</a>
<a class="sourceLine" id="cb92-3" data-line-number="3"><span class="co">#&gt; # A tibble: 3 x 4</span></a>
<a class="sourceLine" id="cb92-4" data-line-number="4"><span class="co">#&gt;   violent.exp.ISAF     `0`     `1`  `&lt;NA&gt;`</span></a>
<a class="sourceLine" id="cb92-5" data-line-number="5"><span class="co">#&gt; *            &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb92-6" data-line-number="6"><span class="co">#&gt; 1                0 0.483   0.129   0.00799</span></a>
<a class="sourceLine" id="cb92-7" data-line-number="7"><span class="co">#&gt; 2                1 0.172   0.191   0.00799</span></a>
<a class="sourceLine" id="cb92-8" data-line-number="8"><span class="co">#&gt; 3               NA 0.00254 0.00290 0.00363</span></a></code></pre></div>
<p><code>drop_na</code> is an alternative to <code>na.omit</code> that allows for removing missing values,</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1"><span class="kw">drop_na</span>(afghan)</a></code></pre></div>
<p><strong>Tip</strong> There are multiple types of <a href="http://r4ds.had.co.nz/vectors.html#important-types-of-atomic-vector">missing values</a>.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1"><span class="ot">NA</span>  <span class="co"># logical</span></a>
<a class="sourceLine" id="cb94-2" data-line-number="2"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb94-3" data-line-number="3"><span class="ot">NA_integer_</span> <span class="co"># integer</span></a>
<a class="sourceLine" id="cb94-4" data-line-number="4"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb94-5" data-line-number="5"><span class="ot">NA_real_</span> <span class="co"># double</span></a>
<a class="sourceLine" id="cb94-6" data-line-number="6"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb94-7" data-line-number="7"><span class="ot">NA_character_</span> <span class="co"># character</span></a>
<a class="sourceLine" id="cb94-8" data-line-number="8"><span class="co">#&gt; [1] NA</span></a></code></pre></div>
<p>In many cases, this distinction does not matter since many functions will coerce these missing
values to the correct vector type.
However, you will need to use these in some tidyverse functions that require the outputs
to be the same type, e.g. <code>map()</code> and most of the other <a href="https://cran.r-project.org/package=purrr">purrr</a> functions,
and <code>if_else()</code>.
The code below produces an error, since the <code>TRUE</code> case returns an integer value (<code>x</code> is an integer), but the <code>FALSE</code> case does not specify the type of <code>NA</code>.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb95-2" data-line-number="2"><span class="kw">class</span>(x)</a>
<a class="sourceLine" id="cb95-3" data-line-number="3"><span class="co">#&gt; [1] &quot;integer&quot;</span></a>
<a class="sourceLine" id="cb95-4" data-line-number="4"><span class="kw">if_else</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, x, <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb95-5" data-line-number="5"><span class="co">#&gt; Error: `false` must be type integer, not logical</span></a></code></pre></div>
<p>So instead of <code>NA</code>, use <code>NA_integer_</code>:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1"><span class="kw">if_else</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, x, <span class="ot">NA_integer_</span>)</a>
<a class="sourceLine" id="cb96-2" data-line-number="2"><span class="co">#&gt; [1]  1  2 NA NA NA</span></a></code></pre></div>
</div>
<div id="visualizing-the-univariate-distribution" class="section level2">
<h2><span class="header-section-number">3.3</span> Visualizing the Univariate Distribution</h2>
<div id="barplot" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Barplot</h3>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1">afghan &lt;-</a>
<a class="sourceLine" id="cb97-2" data-line-number="2"><span class="st">  </span>afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb97-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">violent.exp.ISAF.fct =</span></a>
<a class="sourceLine" id="cb97-4" data-line-number="4">           <span class="kw">fct_explicit_na</span>(<span class="kw">fct_recode</span>(<span class="kw">factor</span>(violent.exp.ISAF),</a>
<a class="sourceLine" id="cb97-5" data-line-number="5">                                      <span class="dt">Harm =</span> <span class="st">&quot;1&quot;</span>, <span class="st">&quot;No Harm&quot;</span> =<span class="st"> &quot;0&quot;</span>),</a>
<a class="sourceLine" id="cb97-6" data-line-number="6">                           <span class="st">&quot;No response&quot;</span>))</a>
<a class="sourceLine" id="cb97-7" data-line-number="7"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">x =</span> violent.exp.ISAF.fct, <span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb97-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb97-9" data-line-number="9"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Response category&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb97-10" data-line-number="10"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Proportion of respondents&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb97-11" data-line-number="11"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Civilian Victimization by the ISAF&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-17-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1">afghan &lt;-</a>
<a class="sourceLine" id="cb98-2" data-line-number="2"><span class="st">  </span>afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">violent.exp.taliban.fct =</span></a>
<a class="sourceLine" id="cb98-4" data-line-number="4">           <span class="kw">fct_explicit_na</span>(<span class="kw">fct_recode</span>(<span class="kw">factor</span>(violent.exp.taliban),</a>
<a class="sourceLine" id="cb98-5" data-line-number="5">                                      <span class="dt">Harm =</span> <span class="st">&quot;1&quot;</span>, <span class="st">&quot;No Harm&quot;</span> =<span class="st"> &quot;0&quot;</span>),</a>
<a class="sourceLine" id="cb98-6" data-line-number="6">                           <span class="st">&quot;No response&quot;</span>))</a>
<a class="sourceLine" id="cb98-7" data-line-number="7"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">x =</span> violent.exp.ISAF.fct, <span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb98-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb98-9" data-line-number="9"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Response category&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb98-10" data-line-number="10"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Proportion of respondents&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb98-11" data-line-number="11"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Civilian Victimization by the Taliban&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-18-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Instead of creating two separate box-plots, create a single plot facetted by ISAF and Taliban:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1"><span class="kw">select</span>(afghan, violent.exp.ISAF, violent.exp.taliban) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb99-2" data-line-number="2"><span class="st">  </span><span class="kw">gather</span>(variable, value) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb99-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">fct_explicit_na</span>(<span class="kw">fct_recode</span>(<span class="kw">factor</span>(value),</a>
<a class="sourceLine" id="cb99-4" data-line-number="4">                                <span class="dt">Harm =</span> <span class="st">&quot;1&quot;</span>, <span class="st">&quot;No Harm&quot;</span> =<span class="st"> &quot;0&quot;</span>),</a>
<a class="sourceLine" id="cb99-5" data-line-number="5">                                <span class="st">&quot;No response&quot;</span>),</a>
<a class="sourceLine" id="cb99-6" data-line-number="6">         <span class="dt">variable =</span> <span class="kw">recode</span>(variable,</a>
<a class="sourceLine" id="cb99-7" data-line-number="7">                           <span class="dt">violent.exp.ISAF =</span> <span class="st">&quot;ISAF&quot;</span>,</a>
<a class="sourceLine" id="cb99-8" data-line-number="8">                           <span class="dt">violent.exp.taliban =</span> <span class="st">&quot;Taliban&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb99-9" data-line-number="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb99-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb99-11" data-line-number="11"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>variable, <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb99-12" data-line-number="12"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Response category&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb99-13" data-line-number="13"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Proportion of respondents&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb99-14" data-line-number="14"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Civilian Victimization&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-19-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>This plot could improved by plotting the two values simultaneously to be able to better compare them.
This will require creating a data frame that has the following columns: perpetrator (<code>ISAF</code>, <code>Taliban</code>) and response (<code>No Harm</code>, <code>Harm</code>, <code>No response</code>).</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1">violent_exp &lt;-</a>
<a class="sourceLine" id="cb100-2" data-line-number="2"><span class="st">  </span>afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb100-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(violent.exp.ISAF, violent.exp.taliban) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb100-4" data-line-number="4"><span class="st">  </span><span class="kw">gather</span>(perpetrator, response) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb100-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perpetrator =</span> <span class="kw">str_replace</span>(perpetrator, <span class="st">&quot;violent</span><span class="ch">\\</span><span class="st">.exp</span><span class="ch">\\</span><span class="st">.&quot;</span>, <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb100-6" data-line-number="6">         <span class="dt">perpetrator =</span> <span class="kw">str_replace</span>(perpetrator, <span class="st">&quot;taliban&quot;</span>, <span class="st">&quot;Taliban&quot;</span>),</a>
<a class="sourceLine" id="cb100-7" data-line-number="7">         <span class="dt">response =</span> <span class="kw">fct_recode</span>(<span class="kw">factor</span>(response), <span class="st">&quot;Harm&quot;</span> =<span class="st"> &quot;1&quot;</span>, <span class="st">&quot;No Harm&quot;</span> =<span class="st"> &quot;0&quot;</span>),</a>
<a class="sourceLine" id="cb100-8" data-line-number="8">         <span class="dt">response =</span> <span class="kw">fct_explicit_na</span>(response, <span class="st">&quot;No response&quot;</span>),</a>
<a class="sourceLine" id="cb100-9" data-line-number="9">         <span class="dt">response =</span> <span class="kw">fct_relevel</span>(response, <span class="kw">c</span>(<span class="st">&quot;No response&quot;</span>, <span class="st">&quot;No Harm&quot;</span>))</a>
<a class="sourceLine" id="cb100-10" data-line-number="10">         ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb100-11" data-line-number="11"><span class="st">  </span><span class="kw">count</span>(perpetrator, response) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb100-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n))</a>
<a class="sourceLine" id="cb100-13" data-line-number="13"><span class="kw">ggplot</span>(violent_exp, <span class="kw">aes</span>(<span class="dt">x =</span> prop, <span class="dt">y =</span> response, <span class="dt">color =</span> perpetrator)) <span class="op">+</span></a>
<a class="sourceLine" id="cb100-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb100-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">ISAF =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">Taliban =</span> <span class="st">&quot;black&quot;</span>))</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-20-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Black was chosen for the Taliban, and Green for ISAF because they are the colors of their respective <a href="https://en.wikipedia.org/wiki/International_Security_Assistance_Force">flags</a>.</p>
</div>
<div id="histogram" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Histogram</h3>
<p>See the documentation for <a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_histogram">geom_histogram</a>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> ..density..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">boundary =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-3" data-line-number="3"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">20</span>, <span class="dv">80</span>, <span class="dt">by =</span> <span class="dv">10</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Distribution of respondent&#39;s age&quot;</span>,</a>
<a class="sourceLine" id="cb101-5" data-line-number="5">       <span class="dt">y =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Density&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/hist_age-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">x =</span> educ.years, <span class="dt">y =</span> ..density..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb102-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">center =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb102-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">median</span>(afghan<span class="op">$</span>educ.years),</a>
<a class="sourceLine" id="cb102-4" data-line-number="4">             <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb102-5" data-line-number="5"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">median</span>(afghan<span class="op">$</span>educ.years),</a>
<a class="sourceLine" id="cb102-6" data-line-number="6">           <span class="dt">y =</span> <span class="fl">0.2</span>, <span class="dt">label =</span> <span class="st">&quot;median&quot;</span>, <span class="dt">hjust =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb102-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Distribution of respondent&#39;s education&quot;</span>,</a>
<a class="sourceLine" id="cb102-8" data-line-number="8">       <span class="dt">x =</span> <span class="st">&quot;Years of education&quot;</span>,</a>
<a class="sourceLine" id="cb102-9" data-line-number="9">       <span class="dt">y =</span> <span class="st">&quot;Density&quot;</span>)</a>
<a class="sourceLine" id="cb102-10" data-line-number="10">  </a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-21-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>There are several alternatives to the histogram.</p>
<p>Density plots (<a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_density">geom_density</a>):</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" data-line-number="1">dens_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">x =</span> age)) <span class="op">+</span></a>
<a class="sourceLine" id="cb103-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_density</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb103-3" data-line-number="3"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">20</span>, <span class="dv">80</span>, <span class="dt">by =</span> <span class="dv">10</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb103-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Distribution of respondent&#39;s age&quot;</span>,</a>
<a class="sourceLine" id="cb103-5" data-line-number="5">       <span class="dt">y =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Density&quot;</span>)</a>
<a class="sourceLine" id="cb103-6" data-line-number="6">dens_plot</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-22-1.png" width="70%" style="display: block; margin: auto;" />
which can be combined with a <a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_rug">geom_rug</a> to create a rug plot, which puts small lines on the axis to represent the value of each observation. It can be combined with a scatter or density plot to add extra detail. Adjust the <code>alpha</code> to modify the color transparency of the rug and address overplotting.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1">dens_plot <span class="op">+</span><span class="st"> </span><span class="kw">geom_rug</span>(<span class="dt">alpha =</span> <span class="fl">.2</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-23-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Frequency polygons (<a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_freqpoly">geom_freqpoly</a>): See <a href="http://r4ds.had.co.nz/">R for Data Science</a> <a href="http://r4ds.had.co.nz/exploratory-data-analysis.html">EDA</a>.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" data-line-number="1"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">x =</span> age)) <span class="op">+</span></a>
<a class="sourceLine" id="cb105-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_freqpoly</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb105-3" data-line-number="3"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">20</span>, <span class="dv">80</span>, <span class="dt">by =</span> <span class="dv">10</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb105-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Distribution of respondent&#39;s age&quot;</span>,</a>
<a class="sourceLine" id="cb105-5" data-line-number="5">       <span class="dt">y =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Density&quot;</span>)</a>
<a class="sourceLine" id="cb105-6" data-line-number="6"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-24-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="boxplot" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Boxplot</h3>
<p>See the documentation for <a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_boxplot">geom_boxplot</a>.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> age)) <span class="op">+</span></a>
<a class="sourceLine" id="cb106-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb106-3" data-line-number="3"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb106-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Distribution of Age&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-25-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" data-line-number="1"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">y =</span> educ.years, <span class="dt">x =</span> province)) <span class="op">+</span></a>
<a class="sourceLine" id="cb107-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb107-3" data-line-number="3"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb107-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Province&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Years of education&quot;</span>,</a>
<a class="sourceLine" id="cb107-5" data-line-number="5">       <span class="dt">title =</span> <span class="st">&quot;Education by Province&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-26-1.png" width="70%" style="display: block; margin: auto;" />
Helmand and Uruzgan have much lower levels of education than the other
provinces, and also report higher levels of violence.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1">afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb108-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(province) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb108-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">educ.years =</span> <span class="kw">mean</span>(educ.years, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb108-4" data-line-number="4">            <span class="dt">violent.exp.taliban =</span></a>
<a class="sourceLine" id="cb108-5" data-line-number="5">              <span class="kw">mean</span>(violent.exp.taliban, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb108-6" data-line-number="6">            <span class="dt">violent.exp.ISAF =</span></a>
<a class="sourceLine" id="cb108-7" data-line-number="7">              <span class="kw">mean</span>(violent.exp.ISAF, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb108-8" data-line-number="8"><span class="st">  </span><span class="kw">arrange</span>(educ.years)</a>
<a class="sourceLine" id="cb108-9" data-line-number="9"><span class="co">#&gt; # A tibble: 5 x 4</span></a>
<a class="sourceLine" id="cb108-10" data-line-number="10"><span class="co">#&gt;   province educ.years violent.exp.taliban violent.exp.ISAF</span></a>
<a class="sourceLine" id="cb108-11" data-line-number="11"><span class="co">#&gt;   &lt;chr&gt;         &lt;dbl&gt;               &lt;dbl&gt;            &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb108-12" data-line-number="12"><span class="co">#&gt; 1 Uruzgan        1.04              0.455             0.496</span></a>
<a class="sourceLine" id="cb108-13" data-line-number="13"><span class="co">#&gt; 2 Helmand        1.60              0.504             0.541</span></a>
<a class="sourceLine" id="cb108-14" data-line-number="14"><span class="co">#&gt; 3 Khost          5.79              0.233             0.242</span></a>
<a class="sourceLine" id="cb108-15" data-line-number="15"><span class="co">#&gt; 4 Kunar          5.93              0.303             0.399</span></a>
<a class="sourceLine" id="cb108-16" data-line-number="16"><span class="co">#&gt; 5 Logar          6.70              0.0802            0.144</span></a></code></pre></div>
<p>An alternatives to the traditional boxplot:</p>
<p>The Tufte boxplot:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;ggthemes&quot;</span>)</a>
<a class="sourceLine" id="cb109-2" data-line-number="2"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">y =</span> educ.years, <span class="dt">x =</span> province)) <span class="op">+</span></a>
<a class="sourceLine" id="cb109-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_tufteboxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb109-4" data-line-number="4"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb109-5" data-line-number="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Province&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Years of education&quot;</span>,</a>
<a class="sourceLine" id="cb109-6" data-line-number="6">       <span class="dt">title =</span> <span class="st">&quot;Education by Province&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-28-1.png" width="70%" style="display: block; margin: auto;" />
Dot plot with jitter and adjusted alpha to avoid overplotting:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">y =</span> educ.years, <span class="dt">x =</span> province)) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="fl">0.25</span>, <span class="dt">height =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb110-3" data-line-number="3">             <span class="dt">alpha =</span> <span class="fl">.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-4" data-line-number="4"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb110-5" data-line-number="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Province&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Years of education&quot;</span>,</a>
<a class="sourceLine" id="cb110-6" data-line-number="6">       <span class="dt">title =</span> <span class="st">&quot;Education by Province&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-29-1.png" width="70%" style="display: block; margin: auto;" />
A violin plot:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" data-line-number="1"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">y =</span> educ.years, <span class="dt">x =</span> province)) <span class="op">+</span></a>
<a class="sourceLine" id="cb111-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_violin</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb111-3" data-line-number="3"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb111-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Province&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Years of education&quot;</span>,</a>
<a class="sourceLine" id="cb111-5" data-line-number="5">       <span class="dt">title =</span> <span class="st">&quot;Education by Province&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-30-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="printing-and-saving-graphics" class="section level3">
<h3><span class="header-section-number">3.3.4</span> Printing and saving graphics</h3>
<p>Use the function <code>rdoc (&quot;ggplot2&quot;, &quot;ggsave&quot;)</code> to save <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a> graphics.
Also, R Markdown files have their own means of creating and saving plots created by code-chunks.</p>
</div>
</div>
<div id="survey-sampling" class="section level2">
<h2><span class="header-section-number">3.4</span> Survey Sampling</h2>
<div id="the-role-of-randomization" class="section level3">
<h3><span class="header-section-number">3.4.1</span> The Role of Randomization</h3>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;afghan.village&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;qss&quot;</span>)</a></code></pre></div>
<p>Box-plots of altitude</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" data-line-number="1"><span class="kw">ggplot</span>(afghan.village, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(village.surveyed,</a>
<a class="sourceLine" id="cb113-2" data-line-number="2">                                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;sampled&quot;</span>, <span class="st">&quot;non-sampled&quot;</span>)),</a>
<a class="sourceLine" id="cb113-3" data-line-number="3">                           <span class="dt">y =</span> altitude)) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb113-5" data-line-number="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Altitude (meter)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-6" data-line-number="6"><span class="st">  </span><span class="kw">coord_flip</span>()</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-32-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Box plots log-population values of sampled and non-sampled</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" data-line-number="1"><span class="kw">ggplot</span>(afghan.village, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(village.surveyed,</a>
<a class="sourceLine" id="cb114-2" data-line-number="2">                                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;sampled&quot;</span>, <span class="st">&quot;non-sampled&quot;</span>)),</a>
<a class="sourceLine" id="cb114-3" data-line-number="3">                           <span class="dt">y =</span> <span class="kw">log</span>(population))) <span class="op">+</span></a>
<a class="sourceLine" id="cb114-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb114-5" data-line-number="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;log(population)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb114-6" data-line-number="6"><span class="st">  </span><span class="kw">coord_flip</span>()</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-33-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>You can also compare these distributions by plotting their densities:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" data-line-number="1"><span class="kw">ggplot</span>(afghan.village, <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw">factor</span>(village.surveyed,</a>
<a class="sourceLine" id="cb115-2" data-line-number="2">                                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;sampled&quot;</span>, <span class="st">&quot;non-sampled&quot;</span>)),</a>
<a class="sourceLine" id="cb115-3" data-line-number="3">                           <span class="dt">x =</span> <span class="kw">log</span>(population))) <span class="op">+</span></a>
<a class="sourceLine" id="cb115-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_density</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb115-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_rug</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb115-6" data-line-number="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;log(population)&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-34-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="non-response-and-other-sources-of-bias" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Non-response and other sources of bias</h3>
<p>Calculate the rates of item non-response by province to the question about civilian victimization by ISAF and Taliban forces (<code>violent.exp.ISAF</code> and
<code>violent.exp.taliban</code>):</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" data-line-number="1">afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb116-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(province) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb116-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">ISAF =</span> <span class="kw">mean</span>(<span class="kw">is.na</span>(violent.exp.ISAF)),</a>
<a class="sourceLine" id="cb116-4" data-line-number="4">            <span class="dt">taliban =</span> <span class="kw">mean</span>(<span class="kw">is.na</span>(violent.exp.taliban))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb116-5" data-line-number="5"><span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>ISAF)</a>
<a class="sourceLine" id="cb116-6" data-line-number="6"><span class="co">#&gt; # A tibble: 5 x 3</span></a>
<a class="sourceLine" id="cb116-7" data-line-number="7"><span class="co">#&gt;   province    ISAF taliban</span></a>
<a class="sourceLine" id="cb116-8" data-line-number="8"><span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb116-9" data-line-number="9"><span class="co">#&gt; 1 Uruzgan  0.0207  0.0620 </span></a>
<a class="sourceLine" id="cb116-10" data-line-number="10"><span class="co">#&gt; 2 Helmand  0.0164  0.0304 </span></a>
<a class="sourceLine" id="cb116-11" data-line-number="11"><span class="co">#&gt; 3 Khost    0.00476 0.00635</span></a>
<a class="sourceLine" id="cb116-12" data-line-number="12"><span class="co">#&gt; 4 Kunar    0       0      </span></a>
<a class="sourceLine" id="cb116-13" data-line-number="13"><span class="co">#&gt; 5 Logar    0       0</span></a></code></pre></div>
<p>Calculate the proportion who support the ISAF using the difference in means
between the ISAF and control groups:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" data-line-number="1">(<span class="kw">mean</span>(<span class="kw">filter</span>(afghan, list.group <span class="op">==</span><span class="st"> &quot;ISAF&quot;</span>)<span class="op">$</span>list.response) <span class="op">-</span></a>
<a class="sourceLine" id="cb117-2" data-line-number="2"><span class="st">  </span><span class="kw">mean</span>(<span class="kw">filter</span>(afghan, list.group <span class="op">==</span><span class="st"> &quot;control&quot;</span>)<span class="op">$</span>list.response))</a>
<a class="sourceLine" id="cb117-3" data-line-number="3"><span class="co">#&gt; [1] 0.049</span></a></code></pre></div>
<p>To calculate the table responses to the list experiment in the control, ISAF,
and Taliban groups:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" data-line-number="1">afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb118-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(list.response, list.group) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb118-3" data-line-number="3"><span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb118-4" data-line-number="4"><span class="st">  </span><span class="kw">glimpse</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb118-5" data-line-number="5"><span class="st">  </span><span class="kw">spread</span>(list.group, n, <span class="dt">fill =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb118-6" data-line-number="6"><span class="co">#&gt; Observations: 12</span></a>
<a class="sourceLine" id="cb118-7" data-line-number="7"><span class="co">#&gt; Variables: 3</span></a>
<a class="sourceLine" id="cb118-8" data-line-number="8"><span class="co">#&gt; $ list.response &lt;int&gt; 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4</span></a>
<a class="sourceLine" id="cb118-9" data-line-number="9"><span class="co">#&gt; $ list.group    &lt;chr&gt; &quot;control&quot;, &quot;ISAF&quot;, &quot;control&quot;, &quot;ISAF&quot;, &quot;taliban&quot;,...</span></a>
<a class="sourceLine" id="cb118-10" data-line-number="10"><span class="co">#&gt; $ n             &lt;int&gt; 188, 174, 265, 278, 433, 265, 260, 287, 200, 182...</span></a>
<a class="sourceLine" id="cb118-11" data-line-number="11"><span class="co">#&gt; # A tibble: 5 x 4</span></a>
<a class="sourceLine" id="cb118-12" data-line-number="12"><span class="co">#&gt; # Groups: list.response [5]</span></a>
<a class="sourceLine" id="cb118-13" data-line-number="13"><span class="co">#&gt;   list.response control  ISAF taliban</span></a>
<a class="sourceLine" id="cb118-14" data-line-number="14"><span class="co">#&gt; *         &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb118-15" data-line-number="15"><span class="co">#&gt; 1             0     188 174         0</span></a>
<a class="sourceLine" id="cb118-16" data-line-number="16"><span class="co">#&gt; 2             1     265 278       433</span></a>
<a class="sourceLine" id="cb118-17" data-line-number="17"><span class="co">#&gt; 3             2     265 260       287</span></a>
<a class="sourceLine" id="cb118-18" data-line-number="18"><span class="co">#&gt; 4             3     200 182       198</span></a>
<a class="sourceLine" id="cb118-19" data-line-number="19"><span class="co">#&gt; 5             4       0  24.0       0</span></a></code></pre></div>
</div>
</div>
<div id="measuring-political-polarization" class="section level2">
<h2><span class="header-section-number">3.5</span> Measuring Political Polarization</h2>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;congress&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;qss&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1"><span class="kw">glimpse</span>(congress)</a>
<a class="sourceLine" id="cb120-2" data-line-number="2"><span class="co">#&gt; Observations: 14,552</span></a>
<a class="sourceLine" id="cb120-3" data-line-number="3"><span class="co">#&gt; Variables: 7</span></a>
<a class="sourceLine" id="cb120-4" data-line-number="4"><span class="co">#&gt; $ congress &lt;int&gt; 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 8...</span></a>
<a class="sourceLine" id="cb120-5" data-line-number="5"><span class="co">#&gt; $ district &lt;int&gt; 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 98, 98, 1, 2, 3, 4, 5, ...</span></a>
<a class="sourceLine" id="cb120-6" data-line-number="6"><span class="co">#&gt; $ state    &lt;chr&gt; &quot;USA&quot;, &quot;ALABAMA&quot;, &quot;ALABAMA&quot;, &quot;ALABAMA&quot;, &quot;ALABAMA&quot;, &quot;A...</span></a>
<a class="sourceLine" id="cb120-7" data-line-number="7"><span class="co">#&gt; $ party    &lt;chr&gt; &quot;Democrat&quot;, &quot;Democrat&quot;, &quot;Democrat&quot;, &quot;Democrat&quot;, &quot;Demo...</span></a>
<a class="sourceLine" id="cb120-8" data-line-number="8"><span class="co">#&gt; $ name     &lt;chr&gt; &quot;TRUMAN&quot;, &quot;BOYKIN  F.&quot;, &quot;GRANT  G.&quot;, &quot;ANDREWS  G.&quot;, &quot;...</span></a>
<a class="sourceLine" id="cb120-9" data-line-number="9"><span class="co">#&gt; $ dwnom1   &lt;dbl&gt; -0.276, -0.026, -0.042, -0.008, -0.082, -0.170, -0.12...</span></a>
<a class="sourceLine" id="cb120-10" data-line-number="10"><span class="co">#&gt; $ dwnom2   &lt;dbl&gt; 0.016, 0.796, 0.999, 1.005, 1.066, 0.870, 0.990, 0.89...</span></a></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" data-line-number="1">q &lt;-</a>
<a class="sourceLine" id="cb121-2" data-line-number="2"><span class="st">  </span>congress <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb121-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(congress <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">80</span>, <span class="dv">112</span>),</a>
<a class="sourceLine" id="cb121-4" data-line-number="4">         party <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Democrat&quot;</span>, <span class="st">&quot;Republican&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb121-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dwnom1, <span class="dt">y =</span> dwnom2, <span class="dt">colour =</span> party)) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb121-7" data-line-number="7"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>congress) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-8" data-line-number="8"><span class="st">  </span><span class="kw">coord_fixed</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb121-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;racial liberalism/conservatism&quot;</span>,</a>
<a class="sourceLine" id="cb121-10" data-line-number="10">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;economic liberalism/conservatism&quot;</span>,</a>
<a class="sourceLine" id="cb121-12" data-line-number="12">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb121-13" data-line-number="13">q</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-40-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>However, since there are colors associated with Democrats (blue) and Republicans (blue), we should use them rather than the defaults.
There’s some evidence that using semantically-resonant colors can help decoding data visualizations (See <a href="http://vis.stanford.edu/files/2013-SemanticColor-EuroVis.pdf">Lin, et al. 2013</a>).
Since I’ll reuse the scale several times, I’ll save it in a variable.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" data-line-number="1">scale_colour_parties &lt;-</a>
<a class="sourceLine" id="cb122-2" data-line-number="2"><span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">Democrat =</span> <span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb122-3" data-line-number="3">                                 <span class="dt">Republican =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb122-4" data-line-number="4">                                 <span class="dt">Other =</span> <span class="st">&quot;green&quot;</span>))</a>
<a class="sourceLine" id="cb122-5" data-line-number="5">q <span class="op">+</span><span class="st"> </span>scale_colour_parties</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-41-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" data-line-number="1">congress <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb123-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dwnom1, <span class="dt">y =</span> dwnom2, <span class="dt">colour =</span> party)) <span class="op">+</span></a>
<a class="sourceLine" id="cb123-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb123-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>congress) <span class="op">+</span></a>
<a class="sourceLine" id="cb123-5" data-line-number="5"><span class="st">  </span><span class="kw">coord_fixed</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb123-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;racial liberalism/conservatism&quot;</span>,</a>
<a class="sourceLine" id="cb123-7" data-line-number="7">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb123-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;economic liberalism/conservatism&quot;</span>,</a>
<a class="sourceLine" id="cb123-9" data-line-number="9">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb123-10" data-line-number="10">  <span class="co">#scale_colour_parties</span></a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-42-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" data-line-number="1">congress <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb124-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(congress, party) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb124-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">dwnom1 =</span> <span class="kw">mean</span>(dwnom1)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb124-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(party <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Democrat&quot;</span>, <span class="st">&quot;Republican&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb124-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> congress, <span class="dt">y =</span> dwnom1,</a>
<a class="sourceLine" id="cb124-6" data-line-number="6">             <span class="dt">colour =</span> <span class="kw">fct_reorder2</span>(party, congress, dwnom1))) <span class="op">+</span></a>
<a class="sourceLine" id="cb124-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb124-8" data-line-number="8"><span class="st">  </span>scale_colour_parties <span class="op">+</span></a>
<a class="sourceLine" id="cb124-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;DW-NOMINATE score (1st Dimension)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Congress&quot;</span>,</a>
<a class="sourceLine" id="cb124-10" data-line-number="10">       <span class="dt">colour =</span> <span class="st">&quot;Party&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-43-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Alternatively, you can plot the mean DW-Nominate scores for each party and congress over time. This plot uses color for parties and lets the points and labels for the first and last congresses (80 and 112) to convey progress through time.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" data-line-number="1">party_means &lt;-</a>
<a class="sourceLine" id="cb125-2" data-line-number="2"><span class="st">  </span>congress <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb125-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(party <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Democrat&quot;</span>, <span class="st">&quot;Republican&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb125-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(party, congress) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb125-5" data-line-number="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">dwnom1 =</span> <span class="kw">mean</span>(dwnom1),</a>
<a class="sourceLine" id="cb125-6" data-line-number="6">            <span class="dt">dwnom2 =</span> <span class="kw">mean</span>(dwnom2))</a>
<a class="sourceLine" id="cb125-7" data-line-number="7"></a>
<a class="sourceLine" id="cb125-8" data-line-number="8">party_endpoints &lt;-</a>
<a class="sourceLine" id="cb125-9" data-line-number="9"><span class="st">  </span>party_means <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb125-10" data-line-number="10"><span class="st">  </span><span class="kw">filter</span>(congress <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="kw">min</span>(congress), <span class="kw">max</span>(congress))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb125-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">label =</span> <span class="kw">str_c</span>(party, congress, <span class="dt">sep =</span> <span class="st">&quot; - &quot;</span>))</a>
<a class="sourceLine" id="cb125-12" data-line-number="12"></a>
<a class="sourceLine" id="cb125-13" data-line-number="13"><span class="kw">ggplot</span>(party_means, </a>
<a class="sourceLine" id="cb125-14" data-line-number="14">         <span class="kw">aes</span>(<span class="dt">x =</span> dwnom1, <span class="dt">y =</span> dwnom2, <span class="dt">color =</span> party,</a>
<a class="sourceLine" id="cb125-15" data-line-number="15">             <span class="dt">group =</span> party)) <span class="op">+</span></a>
<a class="sourceLine" id="cb125-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb125-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_path</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb125-18" data-line-number="18"><span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="dt">data =</span> party_endpoints,</a>
<a class="sourceLine" id="cb125-19" data-line-number="19">                           <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">label =</span> congress),</a>
<a class="sourceLine" id="cb125-20" data-line-number="20">                           <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb125-21" data-line-number="21"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;racial liberalism/conservatism&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb125-22" data-line-number="22"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;economic liberalism/conservatism&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb125-23" data-line-number="23"><span class="st">  </span>scale_colour_parties</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-44-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div id="correlation" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Correlation</h3>
<p>Let’s plot the Gini coefficient</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;USGini&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;qss&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" data-line-number="1"><span class="kw">ggplot</span>(USGini, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> gini)) <span class="op">+</span></a>
<a class="sourceLine" id="cb127-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb127-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb127-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Gini coefficient&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb127-5" data-line-number="5"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Income Inequality&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-46-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>To calculate a measure of party polarization take the code used in the plot of Republican and Democratic party median ideal points and adapt it to calculate the difference in the party medians:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" data-line-number="1">party_polarization &lt;-</a>
<a class="sourceLine" id="cb128-2" data-line-number="2"><span class="st">  </span>congress <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb128-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(congress, party) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb128-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">dwnom1 =</span> <span class="kw">mean</span>(dwnom1)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb128-5" data-line-number="5"><span class="st">  </span><span class="kw">filter</span>(party <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Democrat&quot;</span>, <span class="st">&quot;Republican&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb128-6" data-line-number="6"><span class="st">  </span><span class="kw">spread</span>(party, dwnom1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb128-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">polarization =</span> Republican <span class="op">-</span><span class="st"> </span>Democrat)</a>
<a class="sourceLine" id="cb128-8" data-line-number="8">party_polarization</a>
<a class="sourceLine" id="cb128-9" data-line-number="9"><span class="co">#&gt; # A tibble: 33 x 4</span></a>
<a class="sourceLine" id="cb128-10" data-line-number="10"><span class="co">#&gt; # Groups: congress [33]</span></a>
<a class="sourceLine" id="cb128-11" data-line-number="11"><span class="co">#&gt;   congress Democrat Republican polarization</span></a>
<a class="sourceLine" id="cb128-12" data-line-number="12"><span class="co">#&gt;      &lt;int&gt;    &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb128-13" data-line-number="13"><span class="co">#&gt; 1       80   -0.146      0.276        0.421</span></a>
<a class="sourceLine" id="cb128-14" data-line-number="14"><span class="co">#&gt; 2       81   -0.195      0.264        0.459</span></a>
<a class="sourceLine" id="cb128-15" data-line-number="15"><span class="co">#&gt; 3       82   -0.180      0.265        0.445</span></a>
<a class="sourceLine" id="cb128-16" data-line-number="16"><span class="co">#&gt; 4       83   -0.181      0.261        0.442</span></a>
<a class="sourceLine" id="cb128-17" data-line-number="17"><span class="co">#&gt; 5       84   -0.209      0.261        0.471</span></a>
<a class="sourceLine" id="cb128-18" data-line-number="18"><span class="co">#&gt; 6       85   -0.214      0.250        0.464</span></a>
<a class="sourceLine" id="cb128-19" data-line-number="19"><span class="co">#&gt; # ... with 27 more rows</span></a></code></pre></div>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" data-line-number="1"><span class="kw">ggplot</span>(party_polarization, <span class="kw">aes</span>(<span class="dt">x =</span> congress, <span class="dt">y =</span> polarization)) <span class="op">+</span></a>
<a class="sourceLine" id="cb129-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb129-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb129-4" data-line-number="4"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Political Polarization&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb129-5" data-line-number="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Republican median − Democratic median&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-48-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="quantile-quantile-plot" class="section level3">
<h3><span class="header-section-number">3.5.2</span> Quantile-Quantile Plot</h3>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" data-line-number="1">congress <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb130-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(congress <span class="op">==</span><span class="st"> </span><span class="dv">112</span>, party <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Republican&quot;</span>, <span class="st">&quot;Democrat&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb130-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dwnom2, <span class="dt">y =</span> ..density..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb130-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb130-5" data-line-number="5"><span class="st">  </span><span class="kw">facet_grid</span>(party <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span></a>
<a class="sourceLine" id="cb130-6" data-line-number="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;racial liberalism/conservatism dimension&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-49-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>The package <em>ggplot2</em> includes a function <code>stat_qq</code> which can be used to create qq-plots but it is more suited to comparing a sample distribution with a theoretical distribution, usually the normal one.
However, we can calculate one by hand, which may give more insight into exactly what the qq-plot is doing.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" data-line-number="1">party_qtiles &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb131-2" data-line-number="2">  <span class="dt">probs =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.01</span>),</a>
<a class="sourceLine" id="cb131-3" data-line-number="3">  <span class="dt">Democrat =</span> <span class="kw">quantile</span>(<span class="kw">filter</span>(congress, congress <span class="op">==</span><span class="st"> </span><span class="dv">112</span>,</a>
<a class="sourceLine" id="cb131-4" data-line-number="4">                             party <span class="op">==</span><span class="st"> &quot;Democrat&quot;</span>)<span class="op">$</span>dwnom2,</a>
<a class="sourceLine" id="cb131-5" data-line-number="5">         <span class="dt">probs =</span> probs),</a>
<a class="sourceLine" id="cb131-6" data-line-number="6">  <span class="dt">Republican =</span> <span class="kw">quantile</span>(<span class="kw">filter</span>(congress, congress <span class="op">==</span><span class="st"> </span><span class="dv">112</span>,</a>
<a class="sourceLine" id="cb131-7" data-line-number="7">                               party <span class="op">==</span><span class="st"> &quot;Republican&quot;</span>)<span class="op">$</span>dwnom2,</a>
<a class="sourceLine" id="cb131-8" data-line-number="8">         <span class="dt">probs =</span> probs)</a>
<a class="sourceLine" id="cb131-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb131-10" data-line-number="10">party_qtiles</a>
<a class="sourceLine" id="cb131-11" data-line-number="11"><span class="co">#&gt; # A tibble: 101 x 3</span></a>
<a class="sourceLine" id="cb131-12" data-line-number="12"><span class="co">#&gt;    probs Democrat Republican</span></a>
<a class="sourceLine" id="cb131-13" data-line-number="13"><span class="co">#&gt;    &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb131-14" data-line-number="14"><span class="co">#&gt; 1 0        -0.925     -1.38 </span></a>
<a class="sourceLine" id="cb131-15" data-line-number="15"><span class="co">#&gt; 2 0.0100   -0.672     -0.720</span></a>
<a class="sourceLine" id="cb131-16" data-line-number="16"><span class="co">#&gt; 3 0.0200   -0.619     -0.566</span></a>
<a class="sourceLine" id="cb131-17" data-line-number="17"><span class="co">#&gt; 4 0.0300   -0.593     -0.526</span></a>
<a class="sourceLine" id="cb131-18" data-line-number="18"><span class="co">#&gt; 5 0.0400   -0.567     -0.468</span></a>
<a class="sourceLine" id="cb131-19" data-line-number="19"><span class="co">#&gt; 6 0.0500   -0.560     -0.436</span></a>
<a class="sourceLine" id="cb131-20" data-line-number="20"><span class="co">#&gt; # ... with 95 more rows</span></a></code></pre></div>
<p>The plot looks different than the one in the text since the x- and y-scales are in the original values instead of z-scores (see the next section).</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" data-line-number="1">party_qtiles <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb132-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Democrat, <span class="dt">y =</span> Republican)) <span class="op">+</span></a>
<a class="sourceLine" id="cb132-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb132-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_abline</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb132-5" data-line-number="5"><span class="st">  </span><span class="kw">coord_fixed</span>()</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-51-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="clustering" class="section level2">
<h2><span class="header-section-number">3.6</span> Clustering</h2>
<div id="matrices" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Matrices</h3>
<p>While matrices are great for numerical computations, such as when you are
implementing algorithms, generally keeping data in data frames is more convenient for data wrangling.</p>
<p>See <a href="http://r4ds.had.co.nz/">R for Data Science</a> chapter <a href="http://r4ds.had.co.nz/vectors.html">Vectors</a>.</p>
</div>
<div id="lists" class="section level3">
<h3><span class="header-section-number">3.6.2</span> Lists</h3>
<p>See <a href="http://r4ds.had.co.nz/">R for Data Science</a> chapters <a href="http://r4ds.had.co.nz/vectors.html">Vectors</a> and <a href="http://r4ds.had.co.nz/iteration.html">Iteration</a>, as well as the <a href="https://cran.r-project.org/package=purrr">purrr</a> package for more powerful methods of computing on lists.</p>
</div>
<div id="k-means-algorithms" class="section level3">
<h3><span class="header-section-number">3.6.3</span> k-means algorithms</h3>
<p>Calculate the clusters by the 80th and 112th congresses:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" data-line-number="1">k80two.out &lt;-</a>
<a class="sourceLine" id="cb133-2" data-line-number="2"><span class="st">  </span><span class="kw">kmeans</span>(<span class="kw">select</span>(<span class="kw">filter</span>(congress, congress <span class="op">==</span><span class="st"> </span><span class="dv">80</span>),</a>
<a class="sourceLine" id="cb133-3" data-line-number="3">                       dwnom1, dwnom2),</a>
<a class="sourceLine" id="cb133-4" data-line-number="4">              <span class="dt">centers =</span> <span class="dv">2</span>, <span class="dt">nstart =</span> <span class="dv">5</span>)</a></code></pre></div>
<p>Add the cluster ids to data sets:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" data-line-number="1">congress80 &lt;-</a>
<a class="sourceLine" id="cb134-2" data-line-number="2"><span class="st">  </span>congress <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb134-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(congress <span class="op">==</span><span class="st"> </span><span class="dv">80</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb134-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cluster2 =</span> <span class="kw">factor</span>(k80two.out<span class="op">$</span>cluster))</a></code></pre></div>
<p>We will also create a data sets with the cluster centroids.
These are in the <code>centers</code> element of the cluster object.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" data-line-number="1">k80two.out<span class="op">$</span>centers</a>
<a class="sourceLine" id="cb135-2" data-line-number="2"><span class="co">#&gt;    dwnom1 dwnom2</span></a>
<a class="sourceLine" id="cb135-3" data-line-number="3"><span class="co">#&gt; 1 -0.0484  0.783</span></a>
<a class="sourceLine" id="cb135-4" data-line-number="4"><span class="co">#&gt; 2  0.1468 -0.339</span></a></code></pre></div>
<p>To make it easier to use with <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a>, we need to convert this to a data frame.
The <a href="https://www.rdocumentation.org/packages/broom/topics/tidy">tidy</a> function from the <a href="https://cran.r-project.org/package=broom">broom</a> package:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" data-line-number="1">k80two.clusters &lt;-<span class="st"> </span><span class="kw">tidy</span>(k80two.out)</a>
<a class="sourceLine" id="cb136-2" data-line-number="2">k80two.clusters</a>
<a class="sourceLine" id="cb136-3" data-line-number="3"><span class="co">#&gt;        x1     x2 size withinss cluster</span></a>
<a class="sourceLine" id="cb136-4" data-line-number="4"><span class="co">#&gt; 1 -0.0484  0.783  135     10.9       1</span></a>
<a class="sourceLine" id="cb136-5" data-line-number="5"><span class="co">#&gt; 2  0.1468 -0.339  311     54.9       2</span></a></code></pre></div>
<p>Plot the ideal points and clusters:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" data-line-number="1"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb137-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> congress80,</a>
<a class="sourceLine" id="cb137-3" data-line-number="3">             <span class="kw">aes</span>(<span class="dt">x =</span> dwnom1, <span class="dt">y =</span> dwnom2, <span class="dt">colour =</span> cluster2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb137-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> k80two.clusters, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> x2))</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-56-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" data-line-number="1">congress80 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb138-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(party, cluster2) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb138-3" data-line-number="3"><span class="st">  </span><span class="kw">count</span>()</a>
<a class="sourceLine" id="cb138-4" data-line-number="4"><span class="co">#&gt; # A tibble: 5 x 3</span></a>
<a class="sourceLine" id="cb138-5" data-line-number="5"><span class="co">#&gt; # Groups: party, cluster2 [5]</span></a>
<a class="sourceLine" id="cb138-6" data-line-number="6"><span class="co">#&gt;   party      cluster2     n</span></a>
<a class="sourceLine" id="cb138-7" data-line-number="7"><span class="co">#&gt;   &lt;chr&gt;      &lt;fctr&gt;   &lt;int&gt;</span></a>
<a class="sourceLine" id="cb138-8" data-line-number="8"><span class="co">#&gt; 1 Democrat   1          132</span></a>
<a class="sourceLine" id="cb138-9" data-line-number="9"><span class="co">#&gt; 2 Democrat   2           62</span></a>
<a class="sourceLine" id="cb138-10" data-line-number="10"><span class="co">#&gt; 3 Other      2            2</span></a>
<a class="sourceLine" id="cb138-11" data-line-number="11"><span class="co">#&gt; 4 Republican 1            3</span></a>
<a class="sourceLine" id="cb138-12" data-line-number="12"><span class="co">#&gt; 5 Republican 2          247</span></a></code></pre></div>
<p>And now we can repeat these steps for the 112th congress:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" data-line-number="1">k112two.out &lt;-</a>
<a class="sourceLine" id="cb139-2" data-line-number="2"><span class="st">  </span><span class="kw">kmeans</span>(<span class="kw">select</span>(<span class="kw">filter</span>(congress, congress <span class="op">==</span><span class="st"> </span><span class="dv">112</span>),</a>
<a class="sourceLine" id="cb139-3" data-line-number="3">                dwnom1, dwnom2),</a>
<a class="sourceLine" id="cb139-4" data-line-number="4">         <span class="dt">centers =</span> <span class="dv">2</span>, <span class="dt">nstart =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb139-5" data-line-number="5">congress112 &lt;-</a>
<a class="sourceLine" id="cb139-6" data-line-number="6"><span class="st">  </span><span class="kw">filter</span>(congress, congress <span class="op">==</span><span class="st"> </span><span class="dv">112</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb139-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cluster2 =</span> <span class="kw">factor</span>(k112two.out<span class="op">$</span>cluster))</a>
<a class="sourceLine" id="cb139-8" data-line-number="8">k112two.clusters &lt;-<span class="st"> </span><span class="kw">tidy</span>(k112two.out)</a>
<a class="sourceLine" id="cb139-9" data-line-number="9"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb139-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> congress112,</a>
<a class="sourceLine" id="cb139-11" data-line-number="11">             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> dwnom1, <span class="dt">y =</span> dwnom2, <span class="dt">colour =</span> cluster2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb139-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> k112two.clusters,</a>
<a class="sourceLine" id="cb139-13" data-line-number="13">             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> x2))</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-58-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Number of observations from each party in each cluster:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" data-line-number="1">congress112 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb140-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(party, cluster2) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb140-3" data-line-number="3"><span class="st">  </span><span class="kw">count</span>()</a>
<a class="sourceLine" id="cb140-4" data-line-number="4"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb140-5" data-line-number="5"><span class="co">#&gt; # Groups: party, cluster2 [3]</span></a>
<a class="sourceLine" id="cb140-6" data-line-number="6"><span class="co">#&gt;   party      cluster2     n</span></a>
<a class="sourceLine" id="cb140-7" data-line-number="7"><span class="co">#&gt;   &lt;chr&gt;      &lt;fctr&gt;   &lt;int&gt;</span></a>
<a class="sourceLine" id="cb140-8" data-line-number="8"><span class="co">#&gt; 1 Democrat   1          200</span></a>
<a class="sourceLine" id="cb140-9" data-line-number="9"><span class="co">#&gt; 2 Republican 1            1</span></a>
<a class="sourceLine" id="cb140-10" data-line-number="10"><span class="co">#&gt; 3 Republican 2          242</span></a></code></pre></div>
<p>Now repeat the same with four clusters on the 80th congress:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" data-line-number="1">k80four.out &lt;-</a>
<a class="sourceLine" id="cb141-2" data-line-number="2"><span class="st">  </span><span class="kw">kmeans</span>(<span class="kw">select</span>(<span class="kw">filter</span>(congress, congress <span class="op">==</span><span class="st"> </span><span class="dv">80</span>),</a>
<a class="sourceLine" id="cb141-3" data-line-number="3">                dwnom1, dwnom2),</a>
<a class="sourceLine" id="cb141-4" data-line-number="4">         <span class="dt">centers =</span> <span class="dv">4</span>, <span class="dt">nstart =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb141-5" data-line-number="5">congress80 &lt;-</a>
<a class="sourceLine" id="cb141-6" data-line-number="6"><span class="st">  </span><span class="kw">filter</span>(congress, congress <span class="op">==</span><span class="st"> </span><span class="dv">80</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb141-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cluster2 =</span> <span class="kw">factor</span>(k80four.out<span class="op">$</span>cluster))</a>
<a class="sourceLine" id="cb141-8" data-line-number="8">k80four.clusters &lt;-<span class="st"> </span><span class="kw">tidy</span>(k80four.out)</a>
<a class="sourceLine" id="cb141-9" data-line-number="9"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb141-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> congress80,</a>
<a class="sourceLine" id="cb141-11" data-line-number="11">             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> dwnom1, <span class="dt">y =</span> dwnom2, <span class="dt">colour =</span> cluster2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb141-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> k80four.clusters,</a>
<a class="sourceLine" id="cb141-13" data-line-number="13">             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> x2), <span class="dt">size =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-60-1.png" width="70%" style="display: block; margin: auto;" />
and on the 112th congress:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" data-line-number="1">k112four.out &lt;-</a>
<a class="sourceLine" id="cb142-2" data-line-number="2"><span class="st">  </span><span class="kw">kmeans</span>(<span class="kw">select</span>(<span class="kw">filter</span>(congress, congress <span class="op">==</span><span class="st"> </span><span class="dv">112</span>),</a>
<a class="sourceLine" id="cb142-3" data-line-number="3">                dwnom1, dwnom2),</a>
<a class="sourceLine" id="cb142-4" data-line-number="4">         <span class="dt">centers =</span> <span class="dv">4</span>, <span class="dt">nstart =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb142-5" data-line-number="5">congress112 &lt;-</a>
<a class="sourceLine" id="cb142-6" data-line-number="6"><span class="st">  </span><span class="kw">filter</span>(congress, congress <span class="op">==</span><span class="st"> </span><span class="dv">112</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb142-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cluster2 =</span> <span class="kw">factor</span>(k112four.out<span class="op">$</span>cluster))</a>
<a class="sourceLine" id="cb142-8" data-line-number="8">k112four.clusters &lt;-<span class="st"> </span><span class="kw">tidy</span>(k112four.out)</a>
<a class="sourceLine" id="cb142-9" data-line-number="9"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb142-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> congress112,</a>
<a class="sourceLine" id="cb142-11" data-line-number="11">             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> dwnom1, <span class="dt">y =</span> dwnom2, <span class="dt">colour =</span> cluster2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb142-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> k112four.clusters,</a>
<a class="sourceLine" id="cb142-13" data-line-number="13">             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> x2), <span class="dt">size =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-61-1.png" width="70%" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="causality.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="prediction.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jrnold/qss-tidy/edit/master/measurement.Rmd",
"text": "Edit"
},
"download": ["qss-tidy.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
