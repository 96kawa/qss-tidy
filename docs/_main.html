<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>QSS Tidyverse Code</title>
  <meta name="description" content="QSS Tidyverse Code">
  <meta name="generator" content="bookdown <!--bookdown:version--> and GitBook 2.6.7">

  <meta property="og:title" content="QSS Tidyverse Code" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="jrnold/qss-tidy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="QSS Tidyverse Code" />
  
  
  

<meta name="author" content="Jeffrey B. Arnold">


<meta name="date" content="2018-01-18">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">QSS Tidyverse Code</h1>
<h4 class="author"><em>Jeffrey B. Arnold</em></h4>
<h4 class="date"><em>2018-01-18</em></h4>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#preface">Preface</a><ul>
<li><a href="#colophon">Colophon</a></li>
</ul></li>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a><ul>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#overview-of-the-book"><span class="toc-section-number">1.1</span> Overview of the Book</a></li>
<li><a href="#how-to-use-the-book"><span class="toc-section-number">1.2</span> How to use the Book</a></li>
<li><a href="#introduction-to-r"><span class="toc-section-number">1.3</span> Introduction to R</a><ul>
<li><a href="#arithmetic-operations"><span class="toc-section-number">1.3.1</span> Arithmetic Operations</a></li>
<li><a href="#objects"><span class="toc-section-number">1.3.2</span> Objects</a></li>
<li><a href="#vectors"><span class="toc-section-number">1.3.3</span> Vectors</a></li>
<li><a href="#functions"><span class="toc-section-number">1.3.4</span> Functions</a></li>
<li><a href="#data-files"><span class="toc-section-number">1.3.5</span> Data Files</a></li>
<li><a href="#saving-objects"><span class="toc-section-number">1.3.6</span> Saving Objects</a></li>
<li><a href="#programming-and-learning-tips"><span class="toc-section-number">1.3.7</span> Programming and Learning Tips</a></li>
<li><a href="#style-guide"><span class="toc-section-number">1.3.8</span> Style Guide</a></li>
</ul></li>
</ul></li>
<li><a href="#causality"><span class="toc-section-number">2</span> Causality</a><ul>
<li><a href="#prerequisites-1">Prerequisites</a></li>
<li><a href="#racial-discrimination-in-the-labor-market"><span class="toc-section-number">2.1</span> Racial Discrimination in the Labor Market</a></li>
<li><a href="#subsetting-data-in-r"><span class="toc-section-number">2.2</span> Subsetting Data in R</a><ul>
<li><a href="#subsetting"><span class="toc-section-number">2.2.1</span> Subsetting</a></li>
<li><a href="#simple-conditional-statements"><span class="toc-section-number">2.2.2</span> Simple conditional statements</a></li>
<li><a href="#factor-variables"><span class="toc-section-number">2.2.3</span> Factor Variables</a></li>
</ul></li>
<li><a href="#causal-affects-and-the-counterfactual"><span class="toc-section-number">2.3</span> Causal Affects and the Counterfactual</a></li>
<li><a href="#observational-studies"><span class="toc-section-number">2.4</span> Observational Studies</a><ul>
<li><a href="#confounding-bias"><span class="toc-section-number">2.4.1</span> Confounding Bias</a></li>
<li><a href="#before-and-after-and-difference-in-difference-designs"><span class="toc-section-number">2.4.2</span> Before and After and Difference-in-Difference Designs</a></li>
</ul></li>
<li><a href="#descriptive-statistics-for-a-single-variable"><span class="toc-section-number">2.5</span> Descriptive Statistics for a Single Variable</a></li>
</ul></li>
<li><a href="#measurement"><span class="toc-section-number">3</span> Measurement</a><ul>
<li><a href="#prerequisites-2">Prerequisites</a></li>
<li><a href="#measuring-civilian-victimization-during-wartime"><span class="toc-section-number">3.1</span> Measuring Civilian Victimization during Wartime</a></li>
<li><a href="#handling-missing-data-in-r"><span class="toc-section-number">3.2</span> Handling Missing Data in R</a></li>
<li><a href="#visualizing-the-univariate-distribution"><span class="toc-section-number">3.3</span> Visualizing the Univariate Distribution</a><ul>
<li><a href="#barplot"><span class="toc-section-number">3.3.1</span> Barplot</a></li>
<li><a href="#histogram"><span class="toc-section-number">3.3.2</span> Histogram</a></li>
<li><a href="#boxplot"><span class="toc-section-number">3.3.3</span> Boxplot</a></li>
<li><a href="#printing-and-saving-graphics"><span class="toc-section-number">3.3.4</span> Printing and saving graphics</a></li>
</ul></li>
<li><a href="#survey-sampling"><span class="toc-section-number">3.4</span> Survey Sampling</a><ul>
<li><a href="#the-role-of-randomization"><span class="toc-section-number">3.4.1</span> The Role of Randomization</a></li>
<li><a href="#non-response-and-other-sources-of-bias"><span class="toc-section-number">3.4.2</span> Non-response and other sources of bias</a></li>
</ul></li>
<li><a href="#measuring-political-polarization"><span class="toc-section-number">3.5</span> Measuring Political Polarization</a><ul>
<li><a href="#correlation"><span class="toc-section-number">3.5.1</span> Correlation</a></li>
<li><a href="#quantile-quantile-plot"><span class="toc-section-number">3.5.2</span> Quantile-Quantile Plot</a></li>
</ul></li>
<li><a href="#clustering"><span class="toc-section-number">3.6</span> Clustering</a><ul>
<li><a href="#matrices"><span class="toc-section-number">3.6.1</span> Matrices</a></li>
<li><a href="#lists"><span class="toc-section-number">3.6.2</span> Lists</a></li>
<li><a href="#k-means-algorithms"><span class="toc-section-number">3.6.3</span> k-means algorithms</a></li>
</ul></li>
</ul></li>
<li><a href="#prediction"><span class="toc-section-number">4</span> Prediction</a><ul>
<li><a href="#prerequisites-3">Prerequisites</a></li>
<li><a href="#predicting-election-outcomes"><span class="toc-section-number">4.1</span> Predicting Election Outcomes</a><ul>
<li><a href="#loops-in-r"><span class="toc-section-number">4.1.1</span> Loops in R</a></li>
<li><a href="#general-conditional-statements-in-r"><span class="toc-section-number">4.1.2</span> General Conditional Statements in R</a></li>
<li><a href="#poll-predictions"><span class="toc-section-number">4.1.3</span> Poll Predictions</a></li>
</ul></li>
<li><a href="#linear-regression"><span class="toc-section-number">4.2</span> Linear Regression</a><ul>
<li><a href="#facial-appearance-and-election-outcomes"><span class="toc-section-number">4.2.1</span> Facial Appearance and Election Outcomes</a></li>
<li><a href="#correlation-and-scatter-plots"><span class="toc-section-number">4.2.2</span> Correlation and Scatter Plots</a></li>
<li><a href="#least-squares"><span class="toc-section-number">4.2.3</span> Least Squares</a></li>
<li><a href="#regression-towards-the-mean"><span class="toc-section-number">4.2.4</span> Regression towards the mean</a></li>
<li><a href="#merging-data-sets-in-r"><span class="toc-section-number">4.2.5</span> Merging Data Sets in R</a></li>
<li><a href="#model-fit"><span class="toc-section-number">4.2.6</span> Model Fit</a></li>
</ul></li>
<li><a href="#regression-and-causation"><span class="toc-section-number">4.3</span> Regression and Causation</a><ul>
<li><a href="#randomized-experiments"><span class="toc-section-number">4.3.1</span> Randomized Experiments</a></li>
<li><a href="#regression-with-multiple-predictors"><span class="toc-section-number">4.3.2</span> Regression with multiple predictors</a></li>
<li><a href="#heterogeneous-treatment-effects"><span class="toc-section-number">4.3.3</span> Heterogeneous Treatment Effects</a></li>
<li><a href="#regression-discontinuity-design"><span class="toc-section-number">4.3.4</span> Regression Discontinuity Design</a></li>
</ul></li>
</ul></li>
<li><a href="#discovery"><span class="toc-section-number">5</span> Discovery</a><ul>
<li><a href="#textual-data"><span class="toc-section-number">5.1</span> Textual data</a><ul>
<li><a href="#prerequisites-4">Prerequisites</a></li>
<li><a href="#document-term-matrix"><span class="toc-section-number">5.1.1</span> Document-Term Matrix</a></li>
<li><a href="#topic-discovery"><span class="toc-section-number">5.1.2</span> Topic Discovery</a></li>
<li><a href="#authorship-prediction"><span class="toc-section-number">5.1.3</span> Authorship Prediction</a></li>
<li><a href="#cross-validation"><span class="toc-section-number">5.1.4</span> Cross-Validation</a></li>
</ul></li>
<li><a href="#network-data"><span class="toc-section-number">5.2</span> Network data</a><ul>
<li><a href="#prerequisites-5">Prerequisites</a></li>
<li><a href="#twitter-following-network"><span class="toc-section-number">5.2.1</span> Twitter Following Network</a></li>
</ul></li>
<li><a href="#spatial-data"><span class="toc-section-number">5.3</span> Spatial Data</a><ul>
<li><a href="#prerequisites-6">Prerequisites</a></li>
<li><a href="#spatial-data-in-r"><span class="toc-section-number">5.3.1</span> Spatial Data in R</a></li>
<li><a href="#colors-in-r"><span class="toc-section-number">5.3.2</span> Colors in R</a></li>
<li><a href="#united-states-presidential-elections"><span class="toc-section-number">5.3.3</span> United States Presidential Elections</a></li>
</ul></li>
<li><a href="#america-as-purple-states"><span class="toc-section-number">5.4</span> America as purple states</a><ul>
<li><a href="#expansion-of-walmart"><span class="toc-section-number">5.4.1</span> Expansion of Walmart</a></li>
<li><a href="#animation-in-r"><span class="toc-section-number">5.4.2</span> Animation in R</a></li>
</ul></li>
</ul></li>
<li><a href="#probability"><span class="toc-section-number">6</span> Probability</a><ul>
<li><a href="#prerequisites-7">Prerequisites</a></li>
<li><a href="#probability-1"><span class="toc-section-number">6.1</span> Probability</a><ul>
<li><a href="#frequentist-vs.bayesian"><span class="toc-section-number">6.1.1</span> Frequentist vs. Bayesian</a></li>
<li><a href="#definition-and-axioms"><span class="toc-section-number">6.1.2</span> Definition and Axioms</a></li>
<li><a href="#permutations"><span class="toc-section-number">6.1.3</span> Permutations</a></li>
<li><a href="#sampling-without-replacement"><span class="toc-section-number">6.1.4</span> Sampling without replacement</a></li>
<li><a href="#combinations"><span class="toc-section-number">6.1.5</span> Combinations</a></li>
</ul></li>
<li><a href="#conditional-probability"><span class="toc-section-number">6.2</span> Conditional Probability</a><ul>
<li><a href="#conditional-marginal-and-joint-probabilities"><span class="toc-section-number">6.2.1</span> Conditional, Marginal, and Joint Probabilities</a></li>
<li><a href="#independence"><span class="toc-section-number">6.2.2</span> Independence</a></li>
<li><a href="#bayes-rule"><span class="toc-section-number">6.2.3</span> Bayes’ Rule</a></li>
<li><a href="#predicting-race-using-surname-and-residence-location"><span class="toc-section-number">6.2.4</span> Predicting Race Using Surname and Residence Location</a></li>
<li><a href="#predicting-election-outcomes-with-uncertainty"><span class="toc-section-number">6.2.5</span> Predicting Election Outcomes with Uncertainty</a></li>
</ul></li>
<li><a href="#random-variables-and-probability-distributions"><span class="toc-section-number">6.3</span> Random Variables and Probability Distributions</a><ul>
<li><a href="#bernoulli-and-uniform-distributions"><span class="toc-section-number">6.3.1</span> Bernoulli and Uniform Distributions</a></li>
<li><a href="#binomial-distribution"><span class="toc-section-number">6.3.2</span> Binomial distribution</a></li>
<li><a href="#normal-distribution"><span class="toc-section-number">6.3.3</span> Normal distribution</a></li>
<li><a href="#expectation-and-variance"><span class="toc-section-number">6.3.4</span> Expectation and Variance</a></li>
<li><a href="#predicting-election-outcomes-with-uncertainty-1"><span class="toc-section-number">6.3.5</span> Predicting Election Outcomes with Uncertainty</a></li>
</ul></li>
<li><a href="#large-sample-theorems"><span class="toc-section-number">6.4</span> Large Sample Theorems</a><ul>
<li><a href="#law-of-large-numbers"><span class="toc-section-number">6.4.1</span> Law of Large Numbers</a></li>
<li><a href="#central-limit-theorem"><span class="toc-section-number">6.4.2</span> Central Limit Theorem</a></li>
</ul></li>
</ul></li>
<li><a href="#uncertainty"><span class="toc-section-number">7</span> Uncertainty</a><ul>
<li><a href="#prerequisites-8">Prerequisites</a></li>
<li><a href="#estimation"><span class="toc-section-number">7.1</span> Estimation</a><ul>
<li><a href="#unbiasedness-and-consistency"><span class="toc-section-number">7.1.1</span> Unbiasedness and Consistency</a></li>
<li><a href="#standard-error"><span class="toc-section-number">7.1.2</span> Standard Error</a></li>
<li><a href="#confidence-intervals"><span class="toc-section-number">7.1.3</span> Confidence Intervals</a></li>
<li><a href="#margin-of-error-and-sample-size-calculation-in-polls"><span class="toc-section-number">7.1.4</span> Margin of Error and Sample Size Calculation in Polls</a></li>
<li><a href="#analysis-of-randomized-controlled-trials"><span class="toc-section-number">7.1.5</span> Analysis of Randomized Controlled Trials</a></li>
<li><a href="#analysis-based-on-students-t-distribution"><span class="toc-section-number">7.1.6</span> Analysis Based on Student’s t-Distribution</a></li>
</ul></li>
<li><a href="#hypothesis-testing"><span class="toc-section-number">7.2</span> Hypothesis Testing</a><ul>
<li><a href="#tea-testing-experiment"><span class="toc-section-number">7.2.1</span> Tea-Testing Experiment</a></li>
<li><a href="#the-general-framework"><span class="toc-section-number">7.2.2</span> The General Framework</a></li>
<li><a href="#one-sample-tests"><span class="toc-section-number">7.2.3</span> One-Sample Tests</a></li>
<li><a href="#two-sample-tests"><span class="toc-section-number">7.2.4</span> Two-sample tests</a></li>
<li><a href="#power-analysis"><span class="toc-section-number">7.2.5</span> Power Analysis</a></li>
</ul></li>
<li><a href="#linear-regression-model-with-uncertainty"><span class="toc-section-number">7.3</span> Linear Regression Model with Uncertainty</a><ul>
<li><a href="#linear-regression-as-a-generative-model"><span class="toc-section-number">7.3.1</span> Linear Regression as a Generative Model</a></li>
<li><a href="#inference-about-coefficients"><span class="toc-section-number">7.3.2</span> Inference about coefficients</a></li>
<li><a href="#inference-about-predictions"><span class="toc-section-number">7.3.3</span> Inference about predictions</a></li>
</ul></li>
</ul></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">QSS Tidyverse Code</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<section id="preface" class="level1 unnumbered">
<h1>Preface</h1>
<section id="colophon" class="level2 unnumbered">
<h2>Colophon</h2>
<!--chapter:end:index.Rmd-->
</section>
</section>
<section id="introduction" class="level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<section id="prerequisites" class="level2 unnumbered">
<h2>Prerequisites</h2>
</section>
<section id="overview-of-the-book" class="level2">
<h2><span class="header-section-number">1.1</span> Overview of the Book</h2>
</section>
<section id="how-to-use-the-book" class="level2">
<h2><span class="header-section-number">1.2</span> How to use the Book</h2>
</section>
<section id="introduction-to-r" class="level2">
<h2><span class="header-section-number">1.3</span> Introduction to R</h2>
<section id="arithmetic-operations" class="level3">
<h3><span class="header-section-number">1.3.1</span> Arithmetic Operations</h3>
</section>
<section id="objects" class="level3">
<h3><span class="header-section-number">1.3.2</span> Objects</h3>
</section>
<section id="vectors" class="level3">
<h3><span class="header-section-number">1.3.3</span> Vectors</h3>
</section>
<section id="functions" class="level3">
<h3><span class="header-section-number">1.3.4</span> Functions</h3>
</section>
<section id="data-files" class="level3">
<h3><span class="header-section-number">1.3.5</span> Data Files</h3>
</section>
<section id="saving-objects" class="level3">
<h3><span class="header-section-number">1.3.6</span> Saving Objects</h3>
</section>
<section id="programming-and-learning-tips" class="level3">
<h3><span class="header-section-number">1.3.7</span> Programming and Learning Tips</h3>
</section>
<section id="style-guide" class="level3">
<h3><span class="header-section-number">1.3.8</span> Style Guide</h3>
<!--chapter:end:introduction.Rmd-->
</section>
</section>
</section>
<section id="causality" class="level1">
<h1><span class="header-section-number">2</span> Causality</h1>
<section id="prerequisites-1" class="level2 unnumbered">
<h2>Prerequisites</h2>
</section>
<section id="racial-discrimination-in-the-labor-market" class="level2">
<h2><span class="header-section-number">2.1</span> Racial Discrimination in the Labor Market</h2>
</section>
<section id="subsetting-data-in-r" class="level2">
<h2><span class="header-section-number">2.2</span> Subsetting Data in R</h2>
<section id="subsetting" class="level3">
<h3><span class="header-section-number">2.2.1</span> Subsetting</h3>
</section>
<section id="simple-conditional-statements" class="level3">
<h3><span class="header-section-number">2.2.2</span> Simple conditional statements</h3>
</section>
<section id="factor-variables" class="level3">
<h3><span class="header-section-number">2.2.3</span> Factor Variables</h3>
</section>
</section>
<section id="causal-affects-and-the-counterfactual" class="level2">
<h2><span class="header-section-number">2.3</span> Causal Affects and the Counterfactual</h2>
</section>
<section id="observational-studies" class="level2">
<h2><span class="header-section-number">2.4</span> Observational Studies</h2>
<section id="confounding-bias" class="level3">
<h3><span class="header-section-number">2.4.1</span> Confounding Bias</h3>
</section>
<section id="before-and-after-and-difference-in-difference-designs" class="level3">
<h3><span class="header-section-number">2.4.2</span> Before and After and Difference-in-Difference Designs</h3>
</section>
</section>
<section id="descriptive-statistics-for-a-single-variable" class="level2">
<h2><span class="header-section-number">2.5</span> Descriptive Statistics for a Single Variable</h2>
<!--chapter:end:causality.Rmd-->
</section>
</section>
<section id="measurement" class="level1">
<h1><span class="header-section-number">3</span> Measurement</h1>
<section id="prerequisites-2" class="level2 unnumbered">
<h2>Prerequisites</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(<span class="st">&quot;forcats&quot;</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(<span class="st">&quot;broom&quot;</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(<span class="st">&quot;tidyr&quot;</span>)</a></code></pre></div>
</section>
<section id="measuring-civilian-victimization-during-wartime" class="level2">
<h2><span class="header-section-number">3.1</span> Measuring Civilian Victimization during Wartime</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;afghan&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;qss&quot;</span>)</a></code></pre></div>
<p>Summarize the variables of interest</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(age, educ.years, employed, income) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="kw">summary</span>()</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt;       age         educ.years    employed        income         </span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt;  Min.   :15.0   Min.   : 0   Min.   :0.000   Length:2754       </span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt;  1st Qu.:22.0   1st Qu.: 0   1st Qu.:0.000   Class :character  </span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt;  Median :30.0   Median : 1   Median :1.000   Mode  :character  </span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt;  Mean   :32.4   Mean   : 4   Mean   :0.583                     </span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt;  3rd Qu.:40.0   3rd Qu.: 8   3rd Qu.:1.000                     </span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt;  Max.   :80.0   Max.   :18   Max.   :1.000</span></a></code></pre></div>
<p>Loading data with either <code>data()</code> or<code>read_csv()</code> does not convert strings to factors by default; see below with <code>income</code>. To get a summary of the different levels, either convert it to a factor (see <a href="http://r4ds.had.co.nz/factors.html">R4DS Ch 15</a>), or use <code>count()</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">count</span>(afghan, income)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; # A tibble: 6 x 2</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt;   income              n</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt;   &lt;chr&gt;           &lt;int&gt;</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; 1 10,001-20,000     616</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; 2 2,001-10,000     1420</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; 3 20,001-30,000      93</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; 4 less than 2,000   457</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; 5 over 30,000        14</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; 6 &lt;NA&gt;              154</span></a></code></pre></div>
<p>Use count to calculate the proportion of respondents who answer that they were harmed by the ISAF or the Taliban (<code>violent.exp.ISAF</code> and <code>violent.exp.taliban</code>, respectively):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(violent.exp.ISAF, violent.exp.taliban) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n))</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; # A tibble: 9 x 4</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt;   violent.exp.ISAF violent.exp.taliban     n    prop</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt;              &lt;int&gt;               &lt;int&gt; &lt;int&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; 1                0                   0  1330 0.483  </span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; 2                0                   1   354 0.129  </span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; 3                0                  NA    22 0.00799</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; 4                1                   0   475 0.172  </span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; 5                1                   1   526 0.191  </span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; 6                1                  NA    22 0.00799</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt; # ... with 3 more rows</span></a></code></pre></div>
<p>We need to use <code>ungroup()</code> in order to ensure that <code>sum(n)</code> sums over the entire dataset as opposed to only within categories of <code>violent.exp.ISAF</code>. Unlike <code>prop.table()</code>, the code above does not drop missing values. We can drop those values by adding <code>filter()</code> and <code>!is.na()</code> to test for missing values in those variables:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(violent.exp.ISAF), <span class="op">!</span><span class="kw">is.na</span>(violent.exp.taliban)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(violent.exp.ISAF, violent.exp.taliban) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n))</a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; # A tibble: 4 x 4</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt;   violent.exp.ISAF violent.exp.taliban     n  prop</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt;              &lt;int&gt;               &lt;int&gt; &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; 1                0                   0  1330 0.495</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; 2                0                   1   354 0.132</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; 3                1                   0   475 0.177</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; 4                1                   1   526 0.196</span></a></code></pre></div>
</section>
<section id="handling-missing-data-in-r" class="level2">
<h2><span class="header-section-number">3.2</span> Handling Missing Data in R</h2>
<p>We already observed the issues with <code>NA</code> values in calculating the proportion answering the “experienced violence” questions. You can filter rows with specific variables having missing values using <code>filter()</code> as shown above.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">head</span>(afghan<span class="op">$</span>income, <span class="dt">n =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt;  [1] &quot;2,001-10,000&quot;  &quot;2,001-10,000&quot;  &quot;2,001-10,000&quot;  &quot;2,001-10,000&quot; </span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt;  [5] &quot;2,001-10,000&quot;  NA              &quot;10,001-20,000&quot; &quot;2,001-10,000&quot; </span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt;  [9] &quot;2,001-10,000&quot;  NA</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="kw">head</span>(<span class="kw">is.na</span>(afghan<span class="op">$</span>income), <span class="dt">n =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;  [1] FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE  TRUE</span></a></code></pre></div>
<p>Counts and proportion of missing values of <code>income</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">summarise</span>(afghan,</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">          <span class="dt">n_missing =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(income)),</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">          <span class="dt">p_missing =</span> <span class="kw">mean</span>(<span class="kw">is.na</span>(income)))</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt;   n_missing p_missing</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; 1       154    0.0559</span></a></code></pre></div>
<p>Mean, and other functions, do not by default exclude missing values. Use <code>na.rm = TRUE</code> in these cases.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw">mean</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; [1] 2</span></a></code></pre></div>
<p>Table of proportions of individuals harmed by the ISAF and Taliban that includes missing (<code>NA</code>) values:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">violent_exp_prop &lt;-</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="st">  </span>afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(violent.exp.ISAF, violent.exp.taliban) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>n)</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">violent_exp_prop</a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt; # A tibble: 9 x 3</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt;   violent.exp.ISAF violent.exp.taliban    prop</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt;              &lt;int&gt;               &lt;int&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt; 1                0                   0 0.483  </span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt; 2                0                   1 0.129  </span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt; 3                0                  NA 0.00799</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt; 4                1                   0 0.172  </span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt; 5                1                   1 0.191  </span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt; 6                1                  NA 0.00799</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co">#&gt; # ... with 3 more rows</span></a></code></pre></div>
<p>The data frame above can be reorganized so that rows are ISAF and the columns are Taliban as follows:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">violent_exp_prop <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw">spread</span>(violent.exp.taliban, prop)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt; # A tibble: 3 x 4</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt;   violent.exp.ISAF     `0`     `1`  `&lt;NA&gt;`</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt; *            &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt; 1                0 0.483   0.129   0.00799</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; 2                1 0.172   0.191   0.00799</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt; 3               NA 0.00254 0.00290 0.00363</span></a></code></pre></div>
<p><code>drop_na</code> is an alternative to <code>na.omit</code> that allows for removing missing values,</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">drop_na</span>(afghan)</a></code></pre></div>
<p><strong>Tip</strong> There are multiple types of <a href="http://r4ds.had.co.nz/vectors.html#important-types-of-atomic-vector">missing values</a>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="ot">NA</span>  <span class="co"># logical</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="ot">NA_integer_</span> <span class="co"># integer</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="ot">NA_real_</span> <span class="co"># double</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="ot">NA_character_</span> <span class="co"># character</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">#&gt; [1] NA</span></a></code></pre></div>
<p>In many cases, this distinction does not matter since many functions will coerce these missing values to the correct vector type. However, you will need to use these in some tidyverse functions that require the outputs to be the same type, e.g. <code>map()</code> and most of the other <a href="https://cran.r-project.org/package=purrr">purrr</a> functions, and <code>if_else()</code>. The code below produces an error, since the <code>TRUE</code> case returns an integer value (<code>x</code> is an integer), but the <code>FALSE</code> case does not specify the type of <code>NA</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw">class</span>(x)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">#&gt; [1] &quot;integer&quot;</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="kw">if_else</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, x, <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt; Error: `false` must be type integer, not logical</span></a></code></pre></div>
<p>So instead of <code>NA</code>, use <code>NA_integer_</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">if_else</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, x, <span class="ot">NA_integer_</span>)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="co">#&gt; [1]  1  2 NA NA NA</span></a></code></pre></div>
</section>
<section id="visualizing-the-univariate-distribution" class="level2">
<h2><span class="header-section-number">3.3</span> Visualizing the Univariate Distribution</h2>
<section id="barplot" class="level3">
<h3><span class="header-section-number">3.3.1</span> Barplot</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">afghan &lt;-</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="st">  </span>afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">violent.exp.ISAF.fct =</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4">           <span class="kw">fct_explicit_na</span>(<span class="kw">fct_recode</span>(<span class="kw">factor</span>(violent.exp.ISAF),</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">                                      <span class="dt">Harm =</span> <span class="st">&quot;1&quot;</span>, <span class="st">&quot;No Harm&quot;</span> =<span class="st"> &quot;0&quot;</span>),</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">                           <span class="st">&quot;No response&quot;</span>))</a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">x =</span> violent.exp.ISAF.fct, <span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Response category&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Proportion of respondents&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Civilian Victimization by the ISAF&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-17-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">afghan &lt;-</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="st">  </span>afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">violent.exp.taliban.fct =</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4">           <span class="kw">fct_explicit_na</span>(<span class="kw">fct_recode</span>(<span class="kw">factor</span>(violent.exp.taliban),</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">                                      <span class="dt">Harm =</span> <span class="st">&quot;1&quot;</span>, <span class="st">&quot;No Harm&quot;</span> =<span class="st"> &quot;0&quot;</span>),</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">                           <span class="st">&quot;No response&quot;</span>))</a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">x =</span> violent.exp.ISAF.fct, <span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Response category&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Proportion of respondents&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Civilian Victimization by the Taliban&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-18-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Instead of creating two separate box-plots, create a single plot facetted by ISAF and Taliban:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">select</span>(afghan, violent.exp.ISAF, violent.exp.taliban) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="st">  </span><span class="kw">gather</span>(variable, value) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">fct_explicit_na</span>(<span class="kw">fct_recode</span>(<span class="kw">factor</span>(value),</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">                                <span class="dt">Harm =</span> <span class="st">&quot;1&quot;</span>, <span class="st">&quot;No Harm&quot;</span> =<span class="st"> &quot;0&quot;</span>),</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">                                <span class="st">&quot;No response&quot;</span>),</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">         <span class="dt">variable =</span> <span class="kw">recode</span>(variable,</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">                           <span class="dt">violent.exp.ISAF =</span> <span class="st">&quot;ISAF&quot;</span>,</a>
<a class="sourceLine" id="cb18-8" data-line-number="8">                           <span class="dt">violent.exp.taliban =</span> <span class="st">&quot;Taliban&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>variable, <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Response category&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Proportion of respondents&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Civilian Victimization&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-19-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>This plot could improved by plotting the two values simultaneously to be able to better compare them. This will require creating a data frame that has the following columns: perpetrator (<code>ISAF</code>, <code>Taliban</code>) and response (<code>No Harm</code>, <code>Harm</code>, <code>No response</code>).</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">violent_exp &lt;-</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="st">  </span>afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(violent.exp.ISAF, violent.exp.taliban) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="st">  </span><span class="kw">gather</span>(perpetrator, response) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perpetrator =</span> <span class="kw">str_replace</span>(perpetrator, <span class="st">&quot;violent</span><span class="ch">\\</span><span class="st">.exp</span><span class="ch">\\</span><span class="st">.&quot;</span>, <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb19-6" data-line-number="6">         <span class="dt">perpetrator =</span> <span class="kw">str_replace</span>(perpetrator, <span class="st">&quot;taliban&quot;</span>, <span class="st">&quot;Taliban&quot;</span>),</a>
<a class="sourceLine" id="cb19-7" data-line-number="7">         <span class="dt">response =</span> <span class="kw">fct_recode</span>(<span class="kw">factor</span>(response), <span class="st">&quot;Harm&quot;</span> =<span class="st"> &quot;1&quot;</span>, <span class="st">&quot;No Harm&quot;</span> =<span class="st"> &quot;0&quot;</span>),</a>
<a class="sourceLine" id="cb19-8" data-line-number="8">         <span class="dt">response =</span> <span class="kw">fct_explicit_na</span>(response, <span class="st">&quot;No response&quot;</span>),</a>
<a class="sourceLine" id="cb19-9" data-line-number="9">         <span class="dt">response =</span> <span class="kw">fct_relevel</span>(response, <span class="kw">c</span>(<span class="st">&quot;No response&quot;</span>, <span class="st">&quot;No Harm&quot;</span>))</a>
<a class="sourceLine" id="cb19-10" data-line-number="10">         ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="st">  </span><span class="kw">count</span>(perpetrator, response) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n))</a>
<a class="sourceLine" id="cb19-13" data-line-number="13"><span class="kw">ggplot</span>(violent_exp, <span class="kw">aes</span>(<span class="dt">x =</span> prop, <span class="dt">y =</span> response, <span class="dt">color =</span> perpetrator)) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb19-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">ISAF =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">Taliban =</span> <span class="st">&quot;black&quot;</span>))</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-20-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Black was chosen for the Taliban, and Green for ISAF because they are the colors of their respective <a href="https://en.wikipedia.org/wiki/International_Security_Assistance_Force">flags</a>.</p>
</section>
<section id="histogram" class="level3">
<h3><span class="header-section-number">3.3.2</span> Histogram</h3>
<p>See the documentation for <a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_histogram">geom_histogram</a>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> ..density..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">boundary =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">20</span>, <span class="dv">80</span>, <span class="dt">by =</span> <span class="dv">10</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Distribution of respondent&#39;s age&quot;</span>,</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">       <span class="dt">y =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Density&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/hist_age-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">x =</span> educ.years, <span class="dt">y =</span> ..density..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">center =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">median</span>(afghan<span class="op">$</span>educ.years),</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">             <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">median</span>(afghan<span class="op">$</span>educ.years),</a>
<a class="sourceLine" id="cb21-6" data-line-number="6">           <span class="dt">y =</span> <span class="fl">0.2</span>, <span class="dt">label =</span> <span class="st">&quot;median&quot;</span>, <span class="dt">hjust =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Distribution of respondent&#39;s education&quot;</span>,</a>
<a class="sourceLine" id="cb21-8" data-line-number="8">       <span class="dt">x =</span> <span class="st">&quot;Years of education&quot;</span>,</a>
<a class="sourceLine" id="cb21-9" data-line-number="9">       <span class="dt">y =</span> <span class="st">&quot;Density&quot;</span>)</a>
<a class="sourceLine" id="cb21-10" data-line-number="10">  </a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-21-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>There are several alternatives to the histogram.</p>
<p>Density plots (<a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_density">geom_density</a>):</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">dens_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">x =</span> age)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_density</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">20</span>, <span class="dv">80</span>, <span class="dt">by =</span> <span class="dv">10</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Distribution of respondent&#39;s age&quot;</span>,</a>
<a class="sourceLine" id="cb22-5" data-line-number="5">       <span class="dt">y =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Density&quot;</span>)</a>
<a class="sourceLine" id="cb22-6" data-line-number="6">dens_plot</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-22-1.png" width="70%" style="display: block; margin: auto;" /> which can be combined with a <a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_rug">geom_rug</a> to create a rug plot, which puts small lines on the axis to represent the value of each observation. It can be combined with a scatter or density plot to add extra detail. Adjust the <code>alpha</code> to modify the color transparency of the rug and address overplotting.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">dens_plot <span class="op">+</span><span class="st"> </span><span class="kw">geom_rug</span>(<span class="dt">alpha =</span> <span class="fl">.2</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-23-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Frequency polygons (<a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_freqpoly">geom_freqpoly</a>): See <a href="http://r4ds.had.co.nz/">R for Data Science</a> <a href="http://r4ds.had.co.nz/exploratory-data-analysis.html">EDA</a>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">x =</span> age)) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_freqpoly</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">20</span>, <span class="dv">80</span>, <span class="dt">by =</span> <span class="dv">10</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Distribution of respondent&#39;s age&quot;</span>,</a>
<a class="sourceLine" id="cb24-5" data-line-number="5">       <span class="dt">y =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Density&quot;</span>)</a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-24-1.png" width="70%" style="display: block; margin: auto;" /></p>
</section>
<section id="boxplot" class="level3">
<h3><span class="header-section-number">3.3.3</span> Boxplot</h3>
<p>See the documentation for <a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_boxplot">geom_boxplot</a>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> age)) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Distribution of Age&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-25-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">y =</span> educ.years, <span class="dt">x =</span> province)) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Province&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Years of education&quot;</span>,</a>
<a class="sourceLine" id="cb26-5" data-line-number="5">       <span class="dt">title =</span> <span class="st">&quot;Education by Province&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-26-1.png" width="70%" style="display: block; margin: auto;" /> Helmand and Uruzgan have much lower levels of education than the other provinces, and also report higher levels of violence.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(province) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">educ.years =</span> <span class="kw">mean</span>(educ.years, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb27-4" data-line-number="4">            <span class="dt">violent.exp.taliban =</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5">              <span class="kw">mean</span>(violent.exp.taliban, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb27-6" data-line-number="6">            <span class="dt">violent.exp.ISAF =</span></a>
<a class="sourceLine" id="cb27-7" data-line-number="7">              <span class="kw">mean</span>(violent.exp.ISAF, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-8" data-line-number="8"><span class="st">  </span><span class="kw">arrange</span>(educ.years)</a>
<a class="sourceLine" id="cb27-9" data-line-number="9"><span class="co">#&gt; # A tibble: 5 x 4</span></a>
<a class="sourceLine" id="cb27-10" data-line-number="10"><span class="co">#&gt;   province educ.years violent.exp.taliban violent.exp.ISAF</span></a>
<a class="sourceLine" id="cb27-11" data-line-number="11"><span class="co">#&gt;   &lt;chr&gt;         &lt;dbl&gt;               &lt;dbl&gt;            &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb27-12" data-line-number="12"><span class="co">#&gt; 1 Uruzgan        1.04              0.455             0.496</span></a>
<a class="sourceLine" id="cb27-13" data-line-number="13"><span class="co">#&gt; 2 Helmand        1.60              0.504             0.541</span></a>
<a class="sourceLine" id="cb27-14" data-line-number="14"><span class="co">#&gt; 3 Khost          5.79              0.233             0.242</span></a>
<a class="sourceLine" id="cb27-15" data-line-number="15"><span class="co">#&gt; 4 Kunar          5.93              0.303             0.399</span></a>
<a class="sourceLine" id="cb27-16" data-line-number="16"><span class="co">#&gt; 5 Logar          6.70              0.0802            0.144</span></a></code></pre></div>
<p>An alternatives to the traditional boxplot:</p>
<p>The Tufte boxplot:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;ggthemes&quot;</span>)</a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">y =</span> educ.years, <span class="dt">x =</span> province)) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_tufteboxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb28-5" data-line-number="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Province&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Years of education&quot;</span>,</a>
<a class="sourceLine" id="cb28-6" data-line-number="6">       <span class="dt">title =</span> <span class="st">&quot;Education by Province&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-28-1.png" width="70%" style="display: block; margin: auto;" /> Dot plot with jitter and adjusted alpha to avoid overplotting:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">y =</span> educ.years, <span class="dt">x =</span> province)) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="fl">0.25</span>, <span class="dt">height =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb29-3" data-line-number="3">             <span class="dt">alpha =</span> <span class="fl">.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Province&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Years of education&quot;</span>,</a>
<a class="sourceLine" id="cb29-6" data-line-number="6">       <span class="dt">title =</span> <span class="st">&quot;Education by Province&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-29-1.png" width="70%" style="display: block; margin: auto;" /> A violin plot:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">ggplot</span>(afghan, <span class="kw">aes</span>(<span class="dt">y =</span> educ.years, <span class="dt">x =</span> province)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_violin</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Province&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Years of education&quot;</span>,</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">       <span class="dt">title =</span> <span class="st">&quot;Education by Province&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-30-1.png" width="70%" style="display: block; margin: auto;" /></p>
</section>
<section id="printing-and-saving-graphics" class="level3">
<h3><span class="header-section-number">3.3.4</span> Printing and saving graphics</h3>
<p>Use the function <code>rdoc (&quot;ggplot2&quot;, &quot;ggsave&quot;)</code> to save <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a> graphics. Also, R Markdown files have their own means of creating and saving plots created by code-chunks.</p>
</section>
</section>
<section id="survey-sampling" class="level2">
<h2><span class="header-section-number">3.4</span> Survey Sampling</h2>
<section id="the-role-of-randomization" class="level3">
<h3><span class="header-section-number">3.4.1</span> The Role of Randomization</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;afghan.village&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;qss&quot;</span>)</a></code></pre></div>
<p>Box-plots of altitude</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">ggplot</span>(afghan.village, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(village.surveyed,</a>
<a class="sourceLine" id="cb32-2" data-line-number="2">                                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;sampled&quot;</span>, <span class="st">&quot;non-sampled&quot;</span>)),</a>
<a class="sourceLine" id="cb32-3" data-line-number="3">                           <span class="dt">y =</span> altitude)) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb32-5" data-line-number="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Altitude (meter)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-6" data-line-number="6"><span class="st">  </span><span class="kw">coord_flip</span>()</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-32-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Box plots log-population values of sampled and non-sampled</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">ggplot</span>(afghan.village, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(village.surveyed,</a>
<a class="sourceLine" id="cb33-2" data-line-number="2">                                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;sampled&quot;</span>, <span class="st">&quot;non-sampled&quot;</span>)),</a>
<a class="sourceLine" id="cb33-3" data-line-number="3">                           <span class="dt">y =</span> <span class="kw">log</span>(population))) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb33-5" data-line-number="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;log(population)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-6" data-line-number="6"><span class="st">  </span><span class="kw">coord_flip</span>()</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-33-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>You can also compare these distributions by plotting their densities:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">ggplot</span>(afghan.village, <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw">factor</span>(village.surveyed,</a>
<a class="sourceLine" id="cb34-2" data-line-number="2">                                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;sampled&quot;</span>, <span class="st">&quot;non-sampled&quot;</span>)),</a>
<a class="sourceLine" id="cb34-3" data-line-number="3">                           <span class="dt">x =</span> <span class="kw">log</span>(population))) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_density</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb34-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_rug</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb34-6" data-line-number="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;log(population)&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-34-1.png" width="70%" style="display: block; margin: auto;" /></p>
</section>
<section id="non-response-and-other-sources-of-bias" class="level3">
<h3><span class="header-section-number">3.4.2</span> Non-response and other sources of bias</h3>
<p>Calculate the rates of item non-response by province to the question about civilian victimization by ISAF and Taliban forces (<code>violent.exp.ISAF</code> and <code>violent.exp.taliban</code>):</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(province) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">ISAF =</span> <span class="kw">mean</span>(<span class="kw">is.na</span>(violent.exp.ISAF)),</a>
<a class="sourceLine" id="cb35-4" data-line-number="4">            <span class="dt">taliban =</span> <span class="kw">mean</span>(<span class="kw">is.na</span>(violent.exp.taliban))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-5" data-line-number="5"><span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>ISAF)</a>
<a class="sourceLine" id="cb35-6" data-line-number="6"><span class="co">#&gt; # A tibble: 5 x 3</span></a>
<a class="sourceLine" id="cb35-7" data-line-number="7"><span class="co">#&gt;   province    ISAF taliban</span></a>
<a class="sourceLine" id="cb35-8" data-line-number="8"><span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb35-9" data-line-number="9"><span class="co">#&gt; 1 Uruzgan  0.0207  0.0620 </span></a>
<a class="sourceLine" id="cb35-10" data-line-number="10"><span class="co">#&gt; 2 Helmand  0.0164  0.0304 </span></a>
<a class="sourceLine" id="cb35-11" data-line-number="11"><span class="co">#&gt; 3 Khost    0.00476 0.00635</span></a>
<a class="sourceLine" id="cb35-12" data-line-number="12"><span class="co">#&gt; 4 Kunar    0       0      </span></a>
<a class="sourceLine" id="cb35-13" data-line-number="13"><span class="co">#&gt; 5 Logar    0       0</span></a></code></pre></div>
<p>Calculate the proportion who support the ISAF using the difference in means between the ISAF and control groups:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">(<span class="kw">mean</span>(<span class="kw">filter</span>(afghan, list.group <span class="op">==</span><span class="st"> &quot;ISAF&quot;</span>)<span class="op">$</span>list.response) <span class="op">-</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="st">  </span><span class="kw">mean</span>(<span class="kw">filter</span>(afghan, list.group <span class="op">==</span><span class="st"> &quot;control&quot;</span>)<span class="op">$</span>list.response))</a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="co">#&gt; [1] 0.049</span></a></code></pre></div>
<p>To calculate the table responses to the list experiment in the control, ISAF, and Taliban groups:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">afghan <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(list.response, list.group) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-3" data-line-number="3"><span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-4" data-line-number="4"><span class="st">  </span><span class="kw">glimpse</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-5" data-line-number="5"><span class="st">  </span><span class="kw">spread</span>(list.group, n, <span class="dt">fill =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb37-6" data-line-number="6"><span class="co">#&gt; Observations: 12</span></a>
<a class="sourceLine" id="cb37-7" data-line-number="7"><span class="co">#&gt; Variables: 3</span></a>
<a class="sourceLine" id="cb37-8" data-line-number="8"><span class="co">#&gt; $ list.response &lt;int&gt; 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4</span></a>
<a class="sourceLine" id="cb37-9" data-line-number="9"><span class="co">#&gt; $ list.group    &lt;chr&gt; &quot;control&quot;, &quot;ISAF&quot;, &quot;control&quot;, &quot;ISAF&quot;, &quot;taliban&quot;,...</span></a>
<a class="sourceLine" id="cb37-10" data-line-number="10"><span class="co">#&gt; $ n             &lt;int&gt; 188, 174, 265, 278, 433, 265, 260, 287, 200, 182...</span></a>
<a class="sourceLine" id="cb37-11" data-line-number="11"><span class="co">#&gt; # A tibble: 5 x 4</span></a>
<a class="sourceLine" id="cb37-12" data-line-number="12"><span class="co">#&gt; # Groups: list.response [5]</span></a>
<a class="sourceLine" id="cb37-13" data-line-number="13"><span class="co">#&gt;   list.response control  ISAF taliban</span></a>
<a class="sourceLine" id="cb37-14" data-line-number="14"><span class="co">#&gt; *         &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb37-15" data-line-number="15"><span class="co">#&gt; 1             0     188 174         0</span></a>
<a class="sourceLine" id="cb37-16" data-line-number="16"><span class="co">#&gt; 2             1     265 278       433</span></a>
<a class="sourceLine" id="cb37-17" data-line-number="17"><span class="co">#&gt; 3             2     265 260       287</span></a>
<a class="sourceLine" id="cb37-18" data-line-number="18"><span class="co">#&gt; 4             3     200 182       198</span></a>
<a class="sourceLine" id="cb37-19" data-line-number="19"><span class="co">#&gt; 5             4       0  24.0       0</span></a></code></pre></div>
</section>
</section>
<section id="measuring-political-polarization" class="level2">
<h2><span class="header-section-number">3.5</span> Measuring Political Polarization</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;congress&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;qss&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">glimpse</span>(congress)</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="co">#&gt; Observations: 14,552</span></a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="co">#&gt; Variables: 7</span></a>
<a class="sourceLine" id="cb39-4" data-line-number="4"><span class="co">#&gt; $ congress &lt;int&gt; 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 8...</span></a>
<a class="sourceLine" id="cb39-5" data-line-number="5"><span class="co">#&gt; $ district &lt;int&gt; 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 98, 98, 1, 2, 3, 4, 5, ...</span></a>
<a class="sourceLine" id="cb39-6" data-line-number="6"><span class="co">#&gt; $ state    &lt;chr&gt; &quot;USA&quot;, &quot;ALABAMA&quot;, &quot;ALABAMA&quot;, &quot;ALABAMA&quot;, &quot;ALABAMA&quot;, &quot;A...</span></a>
<a class="sourceLine" id="cb39-7" data-line-number="7"><span class="co">#&gt; $ party    &lt;chr&gt; &quot;Democrat&quot;, &quot;Democrat&quot;, &quot;Democrat&quot;, &quot;Democrat&quot;, &quot;Demo...</span></a>
<a class="sourceLine" id="cb39-8" data-line-number="8"><span class="co">#&gt; $ name     &lt;chr&gt; &quot;TRUMAN&quot;, &quot;BOYKIN  F.&quot;, &quot;GRANT  G.&quot;, &quot;ANDREWS  G.&quot;, &quot;...</span></a>
<a class="sourceLine" id="cb39-9" data-line-number="9"><span class="co">#&gt; $ dwnom1   &lt;dbl&gt; -0.276, -0.026, -0.042, -0.008, -0.082, -0.170, -0.12...</span></a>
<a class="sourceLine" id="cb39-10" data-line-number="10"><span class="co">#&gt; $ dwnom2   &lt;dbl&gt; 0.016, 0.796, 0.999, 1.005, 1.066, 0.870, 0.990, 0.89...</span></a></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">q &lt;-</a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="st">  </span>congress <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb40-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(congress <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">80</span>, <span class="dv">112</span>),</a>
<a class="sourceLine" id="cb40-4" data-line-number="4">         party <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Democrat&quot;</span>, <span class="st">&quot;Republican&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb40-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dwnom1, <span class="dt">y =</span> dwnom2, <span class="dt">colour =</span> party)) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb40-7" data-line-number="7"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>congress) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-8" data-line-number="8"><span class="st">  </span><span class="kw">coord_fixed</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb40-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;racial liberalism/conservatism&quot;</span>,</a>
<a class="sourceLine" id="cb40-10" data-line-number="10">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;economic liberalism/conservatism&quot;</span>,</a>
<a class="sourceLine" id="cb40-12" data-line-number="12">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb40-13" data-line-number="13">q</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-40-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>However, since there are colors associated with Democrats (blue) and Republicans (blue), we should use them rather than the defaults. There’s some evidence that using semantically-resonant colors can help decoding data visualizations (See <a href="http://vis.stanford.edu/files/2013-SemanticColor-EuroVis.pdf">Lin, et al. 2013</a>). Since I’ll reuse the scale several times, I’ll save it in a variable.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">scale_colour_parties &lt;-</a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">Democrat =</span> <span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb41-3" data-line-number="3">                                 <span class="dt">Republican =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb41-4" data-line-number="4">                                 <span class="dt">Other =</span> <span class="st">&quot;green&quot;</span>))</a>
<a class="sourceLine" id="cb41-5" data-line-number="5">q <span class="op">+</span><span class="st"> </span>scale_colour_parties</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-41-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">congress <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dwnom1, <span class="dt">y =</span> dwnom2, <span class="dt">colour =</span> party)) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb42-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>congress) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-5" data-line-number="5"><span class="st">  </span><span class="kw">coord_fixed</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb42-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;racial liberalism/conservatism&quot;</span>,</a>
<a class="sourceLine" id="cb42-7" data-line-number="7">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;economic liberalism/conservatism&quot;</span>,</a>
<a class="sourceLine" id="cb42-9" data-line-number="9">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb42-10" data-line-number="10">  <span class="co">#scale_colour_parties</span></a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-42-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">congress <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(congress, party) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">dwnom1 =</span> <span class="kw">mean</span>(dwnom1)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(party <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Democrat&quot;</span>, <span class="st">&quot;Republican&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> congress, <span class="dt">y =</span> dwnom1,</a>
<a class="sourceLine" id="cb43-6" data-line-number="6">             <span class="dt">colour =</span> <span class="kw">fct_reorder2</span>(party, congress, dwnom1))) <span class="op">+</span></a>
<a class="sourceLine" id="cb43-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb43-8" data-line-number="8"><span class="st">  </span>scale_colour_parties <span class="op">+</span></a>
<a class="sourceLine" id="cb43-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;DW-NOMINATE score (1st Dimension)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Congress&quot;</span>,</a>
<a class="sourceLine" id="cb43-10" data-line-number="10">       <span class="dt">colour =</span> <span class="st">&quot;Party&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-43-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Alternatively, you can plot the mean DW-Nominate scores for each party and congress over time. This plot uses color for parties and lets the points and labels for the first and last congresses (80 and 112) to convey progress through time.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">party_means &lt;-</a>
<a class="sourceLine" id="cb44-2" data-line-number="2"><span class="st">  </span>congress <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb44-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(party <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Democrat&quot;</span>, <span class="st">&quot;Republican&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb44-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(party, congress) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb44-5" data-line-number="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">dwnom1 =</span> <span class="kw">mean</span>(dwnom1),</a>
<a class="sourceLine" id="cb44-6" data-line-number="6">            <span class="dt">dwnom2 =</span> <span class="kw">mean</span>(dwnom2))</a>
<a class="sourceLine" id="cb44-7" data-line-number="7"></a>
<a class="sourceLine" id="cb44-8" data-line-number="8">party_endpoints &lt;-</a>
<a class="sourceLine" id="cb44-9" data-line-number="9"><span class="st">  </span>party_means <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb44-10" data-line-number="10"><span class="st">  </span><span class="kw">filter</span>(congress <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="kw">min</span>(congress), <span class="kw">max</span>(congress))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb44-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">label =</span> <span class="kw">str_c</span>(party, congress, <span class="dt">sep =</span> <span class="st">&quot; - &quot;</span>))</a>
<a class="sourceLine" id="cb44-12" data-line-number="12"></a>
<a class="sourceLine" id="cb44-13" data-line-number="13"><span class="kw">ggplot</span>(party_means, </a>
<a class="sourceLine" id="cb44-14" data-line-number="14">         <span class="kw">aes</span>(<span class="dt">x =</span> dwnom1, <span class="dt">y =</span> dwnom2, <span class="dt">color =</span> party,</a>
<a class="sourceLine" id="cb44-15" data-line-number="15">             <span class="dt">group =</span> party)) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb44-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_path</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb44-18" data-line-number="18"><span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="dt">data =</span> party_endpoints,</a>
<a class="sourceLine" id="cb44-19" data-line-number="19">                           <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">label =</span> congress),</a>
<a class="sourceLine" id="cb44-20" data-line-number="20">                           <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-21" data-line-number="21"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;racial liberalism/conservatism&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-22" data-line-number="22"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;economic liberalism/conservatism&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-23" data-line-number="23"><span class="st">  </span>scale_colour_parties</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-44-1.png" width="70%" style="display: block; margin: auto;" /></p>
<section id="correlation" class="level3">
<h3><span class="header-section-number">3.5.1</span> Correlation</h3>
<p>Let’s plot the Gini coefficient</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;USGini&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;qss&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">ggplot</span>(USGini, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> gini)) <span class="op">+</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb46-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb46-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Gini coefficient&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb46-5" data-line-number="5"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Income Inequality&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-46-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>To calculate a measure of party polarization take the code used in the plot of Republican and Democratic party median ideal points and adapt it to calculate the difference in the party medians:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1">party_polarization &lt;-</a>
<a class="sourceLine" id="cb47-2" data-line-number="2"><span class="st">  </span>congress <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(congress, party) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">dwnom1 =</span> <span class="kw">mean</span>(dwnom1)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-5" data-line-number="5"><span class="st">  </span><span class="kw">filter</span>(party <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Democrat&quot;</span>, <span class="st">&quot;Republican&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-6" data-line-number="6"><span class="st">  </span><span class="kw">spread</span>(party, dwnom1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">polarization =</span> Republican <span class="op">-</span><span class="st"> </span>Democrat)</a>
<a class="sourceLine" id="cb47-8" data-line-number="8">party_polarization</a>
<a class="sourceLine" id="cb47-9" data-line-number="9"><span class="co">#&gt; # A tibble: 33 x 4</span></a>
<a class="sourceLine" id="cb47-10" data-line-number="10"><span class="co">#&gt; # Groups: congress [33]</span></a>
<a class="sourceLine" id="cb47-11" data-line-number="11"><span class="co">#&gt;   congress Democrat Republican polarization</span></a>
<a class="sourceLine" id="cb47-12" data-line-number="12"><span class="co">#&gt;      &lt;int&gt;    &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb47-13" data-line-number="13"><span class="co">#&gt; 1       80   -0.146      0.276        0.421</span></a>
<a class="sourceLine" id="cb47-14" data-line-number="14"><span class="co">#&gt; 2       81   -0.195      0.264        0.459</span></a>
<a class="sourceLine" id="cb47-15" data-line-number="15"><span class="co">#&gt; 3       82   -0.180      0.265        0.445</span></a>
<a class="sourceLine" id="cb47-16" data-line-number="16"><span class="co">#&gt; 4       83   -0.181      0.261        0.442</span></a>
<a class="sourceLine" id="cb47-17" data-line-number="17"><span class="co">#&gt; 5       84   -0.209      0.261        0.471</span></a>
<a class="sourceLine" id="cb47-18" data-line-number="18"><span class="co">#&gt; 6       85   -0.214      0.250        0.464</span></a>
<a class="sourceLine" id="cb47-19" data-line-number="19"><span class="co">#&gt; # ... with 27 more rows</span></a></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">ggplot</span>(party_polarization, <span class="kw">aes</span>(<span class="dt">x =</span> congress, <span class="dt">y =</span> polarization)) <span class="op">+</span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb48-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb48-4" data-line-number="4"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Political Polarization&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb48-5" data-line-number="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Republican median − Democratic median&quot;</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-48-1.png" width="70%" style="display: block; margin: auto;" /></p>
</section>
<section id="quantile-quantile-plot" class="level3">
<h3><span class="header-section-number">3.5.2</span> Quantile-Quantile Plot</h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">congress <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb49-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(congress <span class="op">==</span><span class="st"> </span><span class="dv">112</span>, party <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Republican&quot;</span>, <span class="st">&quot;Democrat&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb49-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dwnom2, <span class="dt">y =</span> ..density..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb49-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb49-5" data-line-number="5"><span class="st">  </span><span class="kw">facet_grid</span>(party <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span></a>
<a class="sourceLine" id="cb49-6" data-line-number="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;racial liberalism/conservatism dimension&quot;</span>)</a>
<a class="sourceLine" id="cb49-7" data-line-number="7"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-49-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>The package <em>ggplot2</em> includes a function <code>stat_qq</code> which can be used to create qq-plots but it is more suited to comparing a sample distribution with a theoretical distribution, usually the normal one. However, we can calculate one by hand, which may give more insight into exactly what the qq-plot is doing.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">party_qtiles &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb50-2" data-line-number="2">  <span class="dt">probs =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.01</span>),</a>
<a class="sourceLine" id="cb50-3" data-line-number="3">  <span class="dt">Democrat =</span> <span class="kw">quantile</span>(<span class="kw">filter</span>(congress, congress <span class="op">==</span><span class="st"> </span><span class="dv">112</span>,</a>
<a class="sourceLine" id="cb50-4" data-line-number="4">                             party <span class="op">==</span><span class="st"> &quot;Democrat&quot;</span>)<span class="op">$</span>dwnom2,</a>
<a class="sourceLine" id="cb50-5" data-line-number="5">         <span class="dt">probs =</span> probs),</a>
<a class="sourceLine" id="cb50-6" data-line-number="6">  <span class="dt">Republican =</span> <span class="kw">quantile</span>(<span class="kw">filter</span>(congress, congress <span class="op">==</span><span class="st"> </span><span class="dv">112</span>,</a>
<a class="sourceLine" id="cb50-7" data-line-number="7">                               party <span class="op">==</span><span class="st"> &quot;Republican&quot;</span>)<span class="op">$</span>dwnom2,</a>
<a class="sourceLine" id="cb50-8" data-line-number="8">         <span class="dt">probs =</span> probs)</a>
<a class="sourceLine" id="cb50-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb50-10" data-line-number="10">party_qtiles</a>
<a class="sourceLine" id="cb50-11" data-line-number="11"><span class="co">#&gt; # A tibble: 101 x 3</span></a>
<a class="sourceLine" id="cb50-12" data-line-number="12"><span class="co">#&gt;    probs Democrat Republican</span></a>
<a class="sourceLine" id="cb50-13" data-line-number="13"><span class="co">#&gt;    &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb50-14" data-line-number="14"><span class="co">#&gt; 1 0        -0.925     -1.38 </span></a>
<a class="sourceLine" id="cb50-15" data-line-number="15"><span class="co">#&gt; 2 0.0100   -0.672     -0.720</span></a>
<a class="sourceLine" id="cb50-16" data-line-number="16"><span class="co">#&gt; 3 0.0200   -0.619     -0.566</span></a>
<a class="sourceLine" id="cb50-17" data-line-number="17"><span class="co">#&gt; 4 0.0300   -0.593     -0.526</span></a>
<a class="sourceLine" id="cb50-18" data-line-number="18"><span class="co">#&gt; 5 0.0400   -0.567     -0.468</span></a>
<a class="sourceLine" id="cb50-19" data-line-number="19"><span class="co">#&gt; 6 0.0500   -0.560     -0.436</span></a>
<a class="sourceLine" id="cb50-20" data-line-number="20"><span class="co">#&gt; # ... with 95 more rows</span></a></code></pre></div>
<p>The plot looks different than the one in the text since the x- and y-scales are in the original values instead of z-scores (see the next section).</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1">party_qtiles <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Democrat, <span class="dt">y =</span> Republican)) <span class="op">+</span></a>
<a class="sourceLine" id="cb51-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb51-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_abline</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb51-5" data-line-number="5"><span class="st">  </span><span class="kw">coord_fixed</span>()</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-51-1.png" width="70%" style="display: block; margin: auto;" /></p>
</section>
</section>
<section id="clustering" class="level2">
<h2><span class="header-section-number">3.6</span> Clustering</h2>
<section id="matrices" class="level3">
<h3><span class="header-section-number">3.6.1</span> Matrices</h3>
<p>While matrices are great for numerical computations, such as when you are implementing algorithms, generally keeping data in data frames is more convenient for data wrangling.</p>
<p>See <a href="http://r4ds.had.co.nz/">R for Data Science</a> chapter <a href="http://r4ds.had.co.nz/vectors.html">Vectors</a>.</p>
</section>
<section id="lists" class="level3">
<h3><span class="header-section-number">3.6.2</span> Lists</h3>
<p>See <a href="http://r4ds.had.co.nz/">R for Data Science</a> chapters <a href="http://r4ds.had.co.nz/vectors.html">Vectors</a> and <a href="http://r4ds.had.co.nz/iteration.html">Iteration</a>, as well as the <a href="https://cran.r-project.org/package=purrr">purrr</a> package for more powerful methods of computing on lists.</p>
</section>
<section id="k-means-algorithms" class="level3">
<h3><span class="header-section-number">3.6.3</span> k-means algorithms</h3>
<p>Calculate the clusters by the 80th and 112th congresses:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">k80two.out &lt;-</a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="st">  </span><span class="kw">kmeans</span>(<span class="kw">select</span>(<span class="kw">filter</span>(congress, congress <span class="op">==</span><span class="st"> </span><span class="dv">80</span>),</a>
<a class="sourceLine" id="cb52-3" data-line-number="3">                       dwnom1, dwnom2),</a>
<a class="sourceLine" id="cb52-4" data-line-number="4">              <span class="dt">centers =</span> <span class="dv">2</span>, <span class="dt">nstart =</span> <span class="dv">5</span>)</a></code></pre></div>
<p>Add the cluster ids to data sets:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">congress80 &lt;-</a>
<a class="sourceLine" id="cb53-2" data-line-number="2"><span class="st">  </span>congress <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb53-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(congress <span class="op">==</span><span class="st"> </span><span class="dv">80</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb53-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cluster2 =</span> <span class="kw">factor</span>(k80two.out<span class="op">$</span>cluster))</a></code></pre></div>
<p>We will also create a data sets with the cluster centroids. These are in the <code>centers</code> element of the cluster object.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1">k80two.out<span class="op">$</span>centers</a>
<a class="sourceLine" id="cb54-2" data-line-number="2"><span class="co">#&gt;    dwnom1 dwnom2</span></a>
<a class="sourceLine" id="cb54-3" data-line-number="3"><span class="co">#&gt; 1 -0.0484  0.783</span></a>
<a class="sourceLine" id="cb54-4" data-line-number="4"><span class="co">#&gt; 2  0.1468 -0.339</span></a></code></pre></div>
<p>To make it easier to use with <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a>, we need to convert this to a data frame. The <a href="https://www.rdocumentation.org/packages/broom/topics/tidy">tidy</a> function from the <a href="https://cran.r-project.org/package=broom">broom</a> package:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">k80two.clusters &lt;-<span class="st"> </span><span class="kw">tidy</span>(k80two.out)</a>
<a class="sourceLine" id="cb55-2" data-line-number="2">k80two.clusters</a>
<a class="sourceLine" id="cb55-3" data-line-number="3"><span class="co">#&gt;        x1     x2 size withinss cluster</span></a>
<a class="sourceLine" id="cb55-4" data-line-number="4"><span class="co">#&gt; 1 -0.0484  0.783  135     10.9       1</span></a>
<a class="sourceLine" id="cb55-5" data-line-number="5"><span class="co">#&gt; 2  0.1468 -0.339  311     54.9       2</span></a></code></pre></div>
<p>Plot the ideal points and clusters:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb56-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> congress80,</a>
<a class="sourceLine" id="cb56-3" data-line-number="3">             <span class="kw">aes</span>(<span class="dt">x =</span> dwnom1, <span class="dt">y =</span> dwnom2, <span class="dt">colour =</span> cluster2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb56-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> k80two.clusters, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> x2))</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-56-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1">congress80 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb57-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(party, cluster2) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb57-3" data-line-number="3"><span class="st">  </span><span class="kw">count</span>()</a>
<a class="sourceLine" id="cb57-4" data-line-number="4"><span class="co">#&gt; # A tibble: 5 x 3</span></a>
<a class="sourceLine" id="cb57-5" data-line-number="5"><span class="co">#&gt; # Groups: party, cluster2 [5]</span></a>
<a class="sourceLine" id="cb57-6" data-line-number="6"><span class="co">#&gt;   party      cluster2     n</span></a>
<a class="sourceLine" id="cb57-7" data-line-number="7"><span class="co">#&gt;   &lt;chr&gt;      &lt;fctr&gt;   &lt;int&gt;</span></a>
<a class="sourceLine" id="cb57-8" data-line-number="8"><span class="co">#&gt; 1 Democrat   1          132</span></a>
<a class="sourceLine" id="cb57-9" data-line-number="9"><span class="co">#&gt; 2 Democrat   2           62</span></a>
<a class="sourceLine" id="cb57-10" data-line-number="10"><span class="co">#&gt; 3 Other      2            2</span></a>
<a class="sourceLine" id="cb57-11" data-line-number="11"><span class="co">#&gt; 4 Republican 1            3</span></a>
<a class="sourceLine" id="cb57-12" data-line-number="12"><span class="co">#&gt; 5 Republican 2          247</span></a></code></pre></div>
<p>And now we can repeat these steps for the 112th congress:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1">k112two.out &lt;-</a>
<a class="sourceLine" id="cb58-2" data-line-number="2"><span class="st">  </span><span class="kw">kmeans</span>(<span class="kw">select</span>(<span class="kw">filter</span>(congress, congress <span class="op">==</span><span class="st"> </span><span class="dv">112</span>),</a>
<a class="sourceLine" id="cb58-3" data-line-number="3">                dwnom1, dwnom2),</a>
<a class="sourceLine" id="cb58-4" data-line-number="4">         <span class="dt">centers =</span> <span class="dv">2</span>, <span class="dt">nstart =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb58-5" data-line-number="5">congress112 &lt;-</a>
<a class="sourceLine" id="cb58-6" data-line-number="6"><span class="st">  </span><span class="kw">filter</span>(congress, congress <span class="op">==</span><span class="st"> </span><span class="dv">112</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cluster2 =</span> <span class="kw">factor</span>(k112two.out<span class="op">$</span>cluster))</a>
<a class="sourceLine" id="cb58-8" data-line-number="8">k112two.clusters &lt;-<span class="st"> </span><span class="kw">tidy</span>(k112two.out)</a>
<a class="sourceLine" id="cb58-9" data-line-number="9"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb58-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> congress112,</a>
<a class="sourceLine" id="cb58-11" data-line-number="11">             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> dwnom1, <span class="dt">y =</span> dwnom2, <span class="dt">colour =</span> cluster2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> k112two.clusters,</a>
<a class="sourceLine" id="cb58-13" data-line-number="13">             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> x2))</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-58-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Number of observations from each party in each cluster:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1">congress112 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb59-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(party, cluster2) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb59-3" data-line-number="3"><span class="st">  </span><span class="kw">count</span>()</a>
<a class="sourceLine" id="cb59-4" data-line-number="4"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb59-5" data-line-number="5"><span class="co">#&gt; # Groups: party, cluster2 [3]</span></a>
<a class="sourceLine" id="cb59-6" data-line-number="6"><span class="co">#&gt;   party      cluster2     n</span></a>
<a class="sourceLine" id="cb59-7" data-line-number="7"><span class="co">#&gt;   &lt;chr&gt;      &lt;fctr&gt;   &lt;int&gt;</span></a>
<a class="sourceLine" id="cb59-8" data-line-number="8"><span class="co">#&gt; 1 Democrat   1          200</span></a>
<a class="sourceLine" id="cb59-9" data-line-number="9"><span class="co">#&gt; 2 Republican 1            1</span></a>
<a class="sourceLine" id="cb59-10" data-line-number="10"><span class="co">#&gt; 3 Republican 2          242</span></a></code></pre></div>
<p>Now repeat the same with four clusters on the 80th congress:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1">k80four.out &lt;-</a>
<a class="sourceLine" id="cb60-2" data-line-number="2"><span class="st">  </span><span class="kw">kmeans</span>(<span class="kw">select</span>(<span class="kw">filter</span>(congress, congress <span class="op">==</span><span class="st"> </span><span class="dv">80</span>),</a>
<a class="sourceLine" id="cb60-3" data-line-number="3">                dwnom1, dwnom2),</a>
<a class="sourceLine" id="cb60-4" data-line-number="4">         <span class="dt">centers =</span> <span class="dv">4</span>, <span class="dt">nstart =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb60-5" data-line-number="5">congress80 &lt;-</a>
<a class="sourceLine" id="cb60-6" data-line-number="6"><span class="st">  </span><span class="kw">filter</span>(congress, congress <span class="op">==</span><span class="st"> </span><span class="dv">80</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb60-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cluster2 =</span> <span class="kw">factor</span>(k80four.out<span class="op">$</span>cluster))</a>
<a class="sourceLine" id="cb60-8" data-line-number="8">k80four.clusters &lt;-<span class="st"> </span><span class="kw">tidy</span>(k80four.out)</a>
<a class="sourceLine" id="cb60-9" data-line-number="9"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb60-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> congress80,</a>
<a class="sourceLine" id="cb60-11" data-line-number="11">             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> dwnom1, <span class="dt">y =</span> dwnom2, <span class="dt">colour =</span> cluster2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb60-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> k80four.clusters,</a>
<a class="sourceLine" id="cb60-13" data-line-number="13">             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> x2), <span class="dt">size =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-60-1.png" width="70%" style="display: block; margin: auto;" /> and on the 112th congress:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1">k112four.out &lt;-</a>
<a class="sourceLine" id="cb61-2" data-line-number="2"><span class="st">  </span><span class="kw">kmeans</span>(<span class="kw">select</span>(<span class="kw">filter</span>(congress, congress <span class="op">==</span><span class="st"> </span><span class="dv">112</span>),</a>
<a class="sourceLine" id="cb61-3" data-line-number="3">                dwnom1, dwnom2),</a>
<a class="sourceLine" id="cb61-4" data-line-number="4">         <span class="dt">centers =</span> <span class="dv">4</span>, <span class="dt">nstart =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb61-5" data-line-number="5">congress112 &lt;-</a>
<a class="sourceLine" id="cb61-6" data-line-number="6"><span class="st">  </span><span class="kw">filter</span>(congress, congress <span class="op">==</span><span class="st"> </span><span class="dv">112</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cluster2 =</span> <span class="kw">factor</span>(k112four.out<span class="op">$</span>cluster))</a>
<a class="sourceLine" id="cb61-8" data-line-number="8">k112four.clusters &lt;-<span class="st"> </span><span class="kw">tidy</span>(k112four.out)</a>
<a class="sourceLine" id="cb61-9" data-line-number="9"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb61-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> congress112,</a>
<a class="sourceLine" id="cb61-11" data-line-number="11">             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> dwnom1, <span class="dt">y =</span> dwnom2, <span class="dt">colour =</span> cluster2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb61-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> k112four.clusters,</a>
<a class="sourceLine" id="cb61-13" data-line-number="13">             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> x2), <span class="dt">size =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="measurement_files/figure-html/unnamed-chunk-61-1.png" width="70%" style="display: block; margin: auto;" /></p>
<!--chapter:end:measurement.Rmd-->
</section>
</section>
</section>
<section id="prediction" class="level1">
<h1><span class="header-section-number">4</span> Prediction</h1>
<section id="prerequisites-3" class="level2 unnumbered">
<h2>Prerequisites</h2>
</section>
<section id="predicting-election-outcomes" class="level2">
<h2><span class="header-section-number">4.1</span> Predicting Election Outcomes</h2>
<section id="loops-in-r" class="level3">
<h3><span class="header-section-number">4.1.1</span> Loops in R</h3>
</section>
<section id="general-conditional-statements-in-r" class="level3">
<h3><span class="header-section-number">4.1.2</span> General Conditional Statements in R</h3>
</section>
<section id="poll-predictions" class="level3">
<h3><span class="header-section-number">4.1.3</span> Poll Predictions</h3>
</section>
</section>
<section id="linear-regression" class="level2">
<h2><span class="header-section-number">4.2</span> Linear Regression</h2>
<section id="facial-appearance-and-election-outcomes" class="level3">
<h3><span class="header-section-number">4.2.1</span> Facial Appearance and Election Outcomes</h3>
</section>
<section id="correlation-and-scatter-plots" class="level3">
<h3><span class="header-section-number">4.2.2</span> Correlation and Scatter Plots</h3>
</section>
<section id="least-squares" class="level3">
<h3><span class="header-section-number">4.2.3</span> Least Squares</h3>
</section>
<section id="regression-towards-the-mean" class="level3">
<h3><span class="header-section-number">4.2.4</span> Regression towards the mean</h3>
</section>
<section id="merging-data-sets-in-r" class="level3">
<h3><span class="header-section-number">4.2.5</span> Merging Data Sets in R</h3>
</section>
<section id="model-fit" class="level3">
<h3><span class="header-section-number">4.2.6</span> Model Fit</h3>
</section>
</section>
<section id="regression-and-causation" class="level2">
<h2><span class="header-section-number">4.3</span> Regression and Causation</h2>
<section id="randomized-experiments" class="level3">
<h3><span class="header-section-number">4.3.1</span> Randomized Experiments</h3>
</section>
<section id="regression-with-multiple-predictors" class="level3">
<h3><span class="header-section-number">4.3.2</span> Regression with multiple predictors</h3>
</section>
<section id="heterogeneous-treatment-effects" class="level3">
<h3><span class="header-section-number">4.3.3</span> Heterogeneous Treatment Effects</h3>
</section>
<section id="regression-discontinuity-design" class="level3">
<h3><span class="header-section-number">4.3.4</span> Regression Discontinuity Design</h3>
<!--chapter:end:prediction.Rmd-->
</section>
</section>
</section>
<section id="discovery" class="level1">
<h1><span class="header-section-number">5</span> Discovery</h1>
<section id="textual-data" class="level2">
<h2><span class="header-section-number">5.1</span> Textual data</h2>
<section id="prerequisites-4" class="level3 unnumbered">
<h3>Prerequisites</h3>
</section>
<section id="document-term-matrix" class="level3">
<h3><span class="header-section-number">5.1.1</span> Document-Term Matrix</h3>
</section>
<section id="topic-discovery" class="level3">
<h3><span class="header-section-number">5.1.2</span> Topic Discovery</h3>
</section>
<section id="authorship-prediction" class="level3">
<h3><span class="header-section-number">5.1.3</span> Authorship Prediction</h3>
</section>
<section id="cross-validation" class="level3">
<h3><span class="header-section-number">5.1.4</span> Cross-Validation</h3>
</section>
</section>
<section id="network-data" class="level2">
<h2><span class="header-section-number">5.2</span> Network data</h2>
<section id="prerequisites-5" class="level3 unnumbered">
<h3>Prerequisites</h3>
</section>
<section id="twitter-following-network" class="level3">
<h3><span class="header-section-number">5.2.1</span> Twitter Following Network</h3>
</section>
</section>
<section id="spatial-data" class="level2">
<h2><span class="header-section-number">5.3</span> Spatial Data</h2>
<section id="prerequisites-6" class="level3 unnumbered">
<h3>Prerequisites</h3>
</section>
<section id="spatial-data-in-r" class="level3">
<h3><span class="header-section-number">5.3.1</span> Spatial Data in R</h3>
</section>
<section id="colors-in-r" class="level3">
<h3><span class="header-section-number">5.3.2</span> Colors in R</h3>
</section>
<section id="united-states-presidential-elections" class="level3">
<h3><span class="header-section-number">5.3.3</span> United States Presidential Elections</h3>
</section>
</section>
<section id="america-as-purple-states" class="level2">
<h2><span class="header-section-number">5.4</span> America as purple states</h2>
<section id="expansion-of-walmart" class="level3">
<h3><span class="header-section-number">5.4.1</span> Expansion of Walmart</h3>
</section>
<section id="animation-in-r" class="level3">
<h3><span class="header-section-number">5.4.2</span> Animation in R</h3>
<!--chapter:end:discovery.Rmd-->
</section>
</section>
</section>
<section id="probability" class="level1">
<h1><span class="header-section-number">6</span> Probability</h1>
<section id="prerequisites-7" class="level2 unnumbered">
<h2>Prerequisites</h2>
</section>
<section id="probability-1" class="level2">
<h2><span class="header-section-number">6.1</span> Probability</h2>
<section id="frequentist-vs.bayesian" class="level3">
<h3><span class="header-section-number">6.1.1</span> Frequentist vs. Bayesian</h3>
</section>
<section id="definition-and-axioms" class="level3">
<h3><span class="header-section-number">6.1.2</span> Definition and Axioms</h3>
</section>
<section id="permutations" class="level3">
<h3><span class="header-section-number">6.1.3</span> Permutations</h3>
</section>
<section id="sampling-without-replacement" class="level3">
<h3><span class="header-section-number">6.1.4</span> Sampling without replacement</h3>
</section>
<section id="combinations" class="level3">
<h3><span class="header-section-number">6.1.5</span> Combinations</h3>
</section>
</section>
<section id="conditional-probability" class="level2">
<h2><span class="header-section-number">6.2</span> Conditional Probability</h2>
<section id="conditional-marginal-and-joint-probabilities" class="level3">
<h3><span class="header-section-number">6.2.1</span> Conditional, Marginal, and Joint Probabilities</h3>
</section>
<section id="independence" class="level3">
<h3><span class="header-section-number">6.2.2</span> Independence</h3>
</section>
<section id="bayes-rule" class="level3">
<h3><span class="header-section-number">6.2.3</span> Bayes’ Rule</h3>
</section>
<section id="predicting-race-using-surname-and-residence-location" class="level3">
<h3><span class="header-section-number">6.2.4</span> Predicting Race Using Surname and Residence Location</h3>
</section>
<section id="predicting-election-outcomes-with-uncertainty" class="level3">
<h3><span class="header-section-number">6.2.5</span> Predicting Election Outcomes with Uncertainty</h3>
</section>
</section>
<section id="random-variables-and-probability-distributions" class="level2">
<h2><span class="header-section-number">6.3</span> Random Variables and Probability Distributions</h2>
<section id="bernoulli-and-uniform-distributions" class="level3">
<h3><span class="header-section-number">6.3.1</span> Bernoulli and Uniform Distributions</h3>
</section>
<section id="binomial-distribution" class="level3">
<h3><span class="header-section-number">6.3.2</span> Binomial distribution</h3>
</section>
<section id="normal-distribution" class="level3">
<h3><span class="header-section-number">6.3.3</span> Normal distribution</h3>
</section>
<section id="expectation-and-variance" class="level3">
<h3><span class="header-section-number">6.3.4</span> Expectation and Variance</h3>
</section>
<section id="predicting-election-outcomes-with-uncertainty-1" class="level3">
<h3><span class="header-section-number">6.3.5</span> Predicting Election Outcomes with Uncertainty</h3>
</section>
</section>
<section id="large-sample-theorems" class="level2">
<h2><span class="header-section-number">6.4</span> Large Sample Theorems</h2>
<section id="law-of-large-numbers" class="level3">
<h3><span class="header-section-number">6.4.1</span> Law of Large Numbers</h3>
</section>
<section id="central-limit-theorem" class="level3">
<h3><span class="header-section-number">6.4.2</span> Central Limit Theorem</h3>
<!--chapter:end:probability.Rmd-->
</section>
</section>
</section>
<section id="uncertainty" class="level1">
<h1><span class="header-section-number">7</span> Uncertainty</h1>
<section id="prerequisites-8" class="level2 unnumbered">
<h2>Prerequisites</h2>
</section>
<section id="estimation" class="level2">
<h2><span class="header-section-number">7.1</span> Estimation</h2>
<section id="unbiasedness-and-consistency" class="level3">
<h3><span class="header-section-number">7.1.1</span> Unbiasedness and Consistency</h3>
</section>
<section id="standard-error" class="level3">
<h3><span class="header-section-number">7.1.2</span> Standard Error</h3>
</section>
<section id="confidence-intervals" class="level3">
<h3><span class="header-section-number">7.1.3</span> Confidence Intervals</h3>
</section>
<section id="margin-of-error-and-sample-size-calculation-in-polls" class="level3">
<h3><span class="header-section-number">7.1.4</span> Margin of Error and Sample Size Calculation in Polls</h3>
</section>
<section id="analysis-of-randomized-controlled-trials" class="level3">
<h3><span class="header-section-number">7.1.5</span> Analysis of Randomized Controlled Trials</h3>
</section>
<section id="analysis-based-on-students-t-distribution" class="level3">
<h3><span class="header-section-number">7.1.6</span> Analysis Based on Student’s t-Distribution</h3>
</section>
</section>
<section id="hypothesis-testing" class="level2">
<h2><span class="header-section-number">7.2</span> Hypothesis Testing</h2>
<section id="tea-testing-experiment" class="level3">
<h3><span class="header-section-number">7.2.1</span> Tea-Testing Experiment</h3>
</section>
<section id="the-general-framework" class="level3">
<h3><span class="header-section-number">7.2.2</span> The General Framework</h3>
</section>
<section id="one-sample-tests" class="level3">
<h3><span class="header-section-number">7.2.3</span> One-Sample Tests</h3>
</section>
<section id="two-sample-tests" class="level3">
<h3><span class="header-section-number">7.2.4</span> Two-sample tests</h3>
</section>
<section id="power-analysis" class="level3">
<h3><span class="header-section-number">7.2.5</span> Power Analysis</h3>
</section>
</section>
<section id="linear-regression-model-with-uncertainty" class="level2">
<h2><span class="header-section-number">7.3</span> Linear Regression Model with Uncertainty</h2>
<section id="linear-regression-as-a-generative-model" class="level3">
<h3><span class="header-section-number">7.3.1</span> Linear Regression as a Generative Model</h3>
</section>
<section id="inference-about-coefficients" class="level3">
<h3><span class="header-section-number">7.3.2</span> Inference about coefficients</h3>
</section>
<section id="inference-about-predictions" class="level3">
<h3><span class="header-section-number">7.3.3</span> Inference about predictions</h3>
<!--chapter:end:uncertainty.Rmd-->
</section>
</section>
</section>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

</body>

</html>
